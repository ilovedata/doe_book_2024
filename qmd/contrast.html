<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>실험계획법 2024 강의 노트 - 4&nbsp; 대비</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../qmd/twolevels.html" rel="next">
<link href="../qmd/block.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
<script type="text/javascript">
 window.MathJax = {
  tex: {
    macros: {
    RR: '{\\mathbb R}',                    // a simple string replacement
    hatmat:'{\\pmb X ({\\pmb X}^t {\\pmb X} )^{-1} {\\pmb X}^t}',
    bold: ['\\boldsymbol{#1}',1] ,     // this macro has one parameter
    pardiff: ['\\frac{\\partial#2}{\\partial#1}', 2, 'x'], // this macro has an optional parameter that defaults to 'x'
    pardifftwo: ['\\frac{\\partial#1}{\\partial#2}', 2]
  },
  environments: {
  braced: ["\\left\\{", "\\right\\}"]
  }
 }
};
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/contrast.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">대비</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">실험계획법 2024 강의 노트</a> 
        <div class="sidebar-tools-main">
    <a href="../실험계획법-2024-강의-노트.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서론</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/oneway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">일원배치법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/twoway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">이원배치법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/block.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">블록설계, 라틴정방설계와 분할법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/contrast.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">대비</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/twolevels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">2수준 요인배치법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/visual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R</code>을 이용한 자료의 시각화 비교</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">일원배치 모형과 최소제곱법</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/raneff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">혼합 모형</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/comfound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">교락</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#카이제곱-분포" id="toc-카이제곱-분포" class="nav-link active" data-scroll-target="#카이제곱-분포"><span class="header-section-number">4.1</span> 카이제곱 분포</a></li>
  <li><a href="#대비" id="toc-대비" class="nav-link" data-scroll-target="#대비"><span class="header-section-number">4.2</span> 대비</a>
  <ul class="collapse">
  <li><a href="#대비의-정의" id="toc-대비의-정의" class="nav-link" data-scroll-target="#대비의-정의"><span class="header-section-number">4.2.1</span> 대비의 정의</a></li>
  <li><a href="#추론" id="toc-추론" class="nav-link" data-scroll-target="#추론"><span class="header-section-number">4.2.2</span> 추론</a></li>
  <li><a href="#표본합" id="toc-표본합" class="nav-link" data-scroll-target="#표본합"><span class="header-section-number">4.2.3</span> 표본합</a></li>
  </ul></li>
  <li><a href="#직교-대비" id="toc-직교-대비" class="nav-link" data-scroll-target="#직교-대비"><span class="header-section-number">4.3</span> 직교 대비</a>
  <ul class="collapse">
  <li><a href="#직교-대비의-정의" id="toc-직교-대비의-정의" class="nav-link" data-scroll-target="#직교-대비의-정의"><span class="header-section-number">4.3.1</span> 직교 대비의 정의</a></li>
  <li><a href="#처리-제곱합의-분해" id="toc-처리-제곱합의-분해" class="nav-link" data-scroll-target="#처리-제곱합의-분해"><span class="header-section-number">4.3.2</span> 처리 제곱합의 분해</a></li>
  <li><a href="#대표적인-대비" id="toc-대표적인-대비" class="nav-link" data-scroll-target="#대표적인-대비"><span class="header-section-number">4.3.3</span> 대표적인 대비</a></li>
  </ul></li>
  <li><a href="#교과서-예제-7.1" id="toc-교과서-예제-7.1" class="nav-link" data-scroll-target="#교과서-예제-7.1"><span class="header-section-number">4.4</span> 교과서 예제 7.1</a>
  <ul class="collapse">
  <li><a href="#이원배치-자료" id="toc-이원배치-자료" class="nav-link" data-scroll-target="#이원배치-자료"><span class="header-section-number">4.4.1</span> 이원배치 자료</a></li>
  <li><a href="#분산분석표" id="toc-분산분석표" class="nav-link" data-scroll-target="#분산분석표"><span class="header-section-number">4.4.2</span> 분산분석표</a></li>
  <li><a href="#직교대비에-대한-제곱합의-분해" id="toc-직교대비에-대한-제곱합의-분해" class="nav-link" data-scroll-target="#직교대비에-대한-제곱합의-분해"><span class="header-section-number">4.4.3</span> 직교대비에 대한 제곱합의 분해</a></li>
  <li><a href="#직교대비에-대한-검정" id="toc-직교대비에-대한-검정" class="nav-link" data-scroll-target="#직교대비에-대한-검정"><span class="header-section-number">4.4.4</span> 직교대비에 대한 검정</a></li>
  <li><a href="#두-요인을-모두-나타내는-분산분석" id="toc-두-요인을-모두-나타내는-분산분석" class="nav-link" data-scroll-target="#두-요인을-모두-나타내는-분산분석"><span class="header-section-number">4.4.5</span> 두 요인을 모두 나타내는 분산분석</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-contrast" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">대비</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="카이제곱-분포" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="카이제곱-분포"><span class="header-section-number">4.1</span> 카이제곱 분포</h2>
<p>자유도가 1인 카이제곱 분포 (<span class="math inline">\(\chi^2\)</span>-distribution)은 평균이 0이고 분산이 1인 정규분포(표준 정규분포)를 따르는 확률변수의 제곱이 따르는 분포이다.</p>
<p><span id="eq-chidist1"><span class="math display">\[
z \sim N(0,1) \quad \rightarrow \quad z^2 \sim \chi^2(1)
\tag{4.1}\]</span></span></p>
<p>만약 <span class="math inline">\(k\)</span> 개의 확률변수 <span class="math inline">\(z_1, z_2, \dots, z_k\)</span>가 서로 독립이고 각각 표준 정규분포 <span class="math inline">\(N(0,1)\)</span>를 따른다면 확률변수의 제곱들의 합은 자유도가 k인 카이제곱 분포 <span class="math inline">\(\chi^2(k)\)</span> 를 따른다.</p>
<p><span id="eq-chidist2"><span class="math display">\[
z_1, z_2, \dots, z_k \sim_{ind} N(0,1) \quad \rightarrow \quad \sum_{i=1}^k z_i^2  \sim \chi^2(k)
\tag{4.2}\]</span></span></p>
<p>만약 <span class="math inline">\(k\)</span> 개의 확률변수 <span class="math inline">\(z_1, z_2, \dots, z_k\)</span>가 서로 독립이고 각각 <strong>정규분포 <span class="math inline">\(N(\mu_i,\sigma^2)\)</span></strong>를 따른다면 표준화 확률변수의 제곱들의 합은 자유도가 k인 카이제곱 분포 <span class="math inline">\(\chi^2(k)\)</span> 를 따른다.</p>
<p><span id="eq-chidist3"><span class="math display">\[
\sum_{i=1}^k  \left [ \frac{z_i - \mu_i}{\sigma} \right ]^2 \sim \chi^2(k)
\tag{4.3}\]</span></span></p>
</section>
<section id="대비" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="대비"><span class="header-section-number">4.2</span> 대비</h2>
<section id="대비의-정의" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="대비의-정의"><span class="header-section-number">4.2.1</span> 대비의 정의</h3>
<p>다음과 같은 균형자료를 가지는 일원배치 모형을 고려하자.</p>
<p><span id="eq-oneway2"><span class="math display">\[
x_{ij} = \mu + \alpha_i + e_{ij}, \quad i=1,2,\dots, a,~~ j= 1,2,\dots, r
\tag{4.4}\]</span></span></p>
<p>위의 일원배치 모형 <a href="#eq-oneway2" class="quarto-xref">식&nbsp;<span>4.4</span></a> 에서 오차항 <span class="math inline">\(e_{ij}\)</span>가 정규분포 <span class="math inline">\(N(0, \sigma^2)\)</span> 을 따른다고 가정하자.</p>
<p>지금까지 우리는 다음과 같은 가설검정에 대한 통계적 추론을 배웠다.</p>
<p><span class="math display">\[ H_0: \alpha_1 = \alpha_2 =\cdots = \alpha_a \quad \text{vs.} \quad H_1: ~ \text{not } H_0\]</span></p>
<p><span id="eq-hypo0"><span class="math display">\[
H_0 : \alpha_i - \alpha_j =0 \quad \text{vs.} \quad H_1: \alpha_i - \alpha_j \ne 0
\tag{4.5}\]</span></span></p>
<p>위의 첫 번째 가설은 요인 <span class="math inline">\(A\)</span>의 효과가 있는지에 대한 검정이며 분산분석표를 이용한 F-통계량으로 검정한다. 두 번째 가설은 각 처리 수준의 차이에 대한 검정이며 평균의 차이를 이용한 t-통계량으로 검정한다.</p>
<p>이제 조금 더 복잡한 가설검정을 고려해보자.</p>
<p>만약 수준이 3개인 경우(<span class="math inline">\(a=3\)</span>) 첫 번째 수준과 두 번째 수준의 평균이 세 번째 수준과 같은지 검정하고 싶다고 하자 [교과서 예제 7.1 (2)]</p>
<p><span id="eq-hypo1"><span class="math display">\[
H_0 : \frac{\alpha_1 + \alpha_2}{2} = \alpha_3 \quad \text{vs.} \quad H_1: ~ \text{not } H_0
\tag{4.6}\]</span></span></p>
<p>또는 만약 요인이 온도인 경우 3개의 수준을 각각 100, 110, 120도로 같은 간격으로 증가시켰다. 반응변수의 평균이 일차적인 추세(linear trend)를 보이고 변화하는지 검정하고 싶을 경우가 있다. 또는 반응변수의 평균이 이차적인 추세(quadratic trend)를 가지는지 확인하고 싶은 경우도 있을 것이다.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/threelevelcontrast.png" class="img-fluid figure-img"></p>
<figcaption>3개의 수준이 있는 경우 선형 추세와 이차식 추세</figcaption>
</figure>
</div>
<p>만약 반응변수의 평균이 일차적인 추세(linear trend)를 보이면 수준의 순서에 따라서 평균이 일차적으로 증가 또는 감소하므로 두 평균의 변화를 합한 값, 즉 <span class="math inline">\((\alpha_2-\alpha_1) + (\alpha_3 - \alpha_2)\)</span> 이 0 과 차이가 날 것이다.<br>
<span class="math display">\[ |(\alpha_2-\alpha_1) + (\alpha_3 - \alpha_2)| = |\alpha_1 - \alpha_3| &gt; 0 \]</span></p>
<p>반면 반응변수의 평균이 이차적인 추세(quadratic trend)를 보이면 수준의 순서에 따라서 평균이 감소했다 증가하거나 또는 감소했다가 증가할 것이므로 두 평균의 변화를 뺀 값, 즉 <span class="math inline">\((\alpha_2-\alpha_1) - (\alpha_3 - \alpha_2)\)</span> 이 0 과 차이가 날 것이다.</p>
<p><span class="math display">\[ |(\alpha_2-\alpha_1) - (\alpha_3 - \alpha_2)| = | \alpha_1 - 2 \alpha_2 + \alpha_3 |&gt; 0 \]</span></p>
<p>따라서 선형식 <span class="math inline">\(\psi=\sum_i c_i \alpha_i\)</span>를 다음과 같이 정의하면 선형식 <span class="math inline">\(\psi\)</span>의 추정량 <span class="math inline">\(\hat \psi\)</span>의 값이 클수록 반응변수의 평균이 선형적으로 변화하는 증거가 커진다.</p>
<p><span class="math display">\[ \psi = (\alpha_2-\alpha_1) + (\alpha_3 - \alpha_2) = -\alpha_1 + \alpha_3 \]</span></p>
<p>따라서 가설검정을 다음과 같이 세운다. 귀무 가설을 기각하면 평균이 선형적으로 변화한다는 것을 의미한다.<br>
<span id="eq-hypo2"><span class="math display">\[
H_0 : \alpha_1 - \alpha_3 = 0  \quad \text{ equvalently } \quad H_0: \text{ not } H_0
\tag{4.7}\]</span></span></p>
<p>위에서 제시한 2개의 가설 <a href="#eq-hypo1" class="quarto-xref">식&nbsp;<span>4.6</span></a> 과 <a href="#eq-hypo2" class="quarto-xref">식&nbsp;<span>4.7</span></a> 의 경우는 모수들의 특별한 선형조합으로 표시되는 가설이다. 이러한 모수들의 선형 조합으로 표시된 가설은 다음과 같이 일반적으로 나타낼 수 있다.</p>
<p><span id="eq-hypogeneral"><span class="math display">\[
H_0: ~ \sum_{i=1}^a c_i \alpha_i = 0
\tag{4.8}\]</span></span></p>
<p>위의 가설 <a href="#eq-hypo1" class="quarto-xref">식&nbsp;<span>4.6</span></a> 은 일반적인 가설 <a href="#eq-hypogeneral" class="quarto-xref">식&nbsp;<span>4.8</span></a> 에서 계수 <span class="math inline">\(c_i\)</span>들이 다음과 같은 경우이며</p>
<p><span class="math display">\[ c_1 = c_2 = 1/2, ~~c_3 =-1 \]</span></p>
<p>가설 <a href="#eq-hypo2" class="quarto-xref">식&nbsp;<span>4.7</span></a> 은 일반적인 가설 <a href="#eq-hypogeneral" class="quarto-xref">식&nbsp;<span>4.8</span></a> 에서 계수 <span class="math inline">\(c_i\)</span>들이 다음과 같은 경우이며</p>
<p><span class="math display">\[ c_1 = -1, ~ c_2= 0,~ c_3 =1 \]</span></p>
<p>물론 두 개의 처리수준을 비교하는 가설 <a href="#eq-hypo0" class="quarto-xref">식&nbsp;<span>4.5</span></a> 도 일반적인 가설의 범주에 속한다. 이 경우 <span class="math inline">\(c_i=1\)</span>, <span class="math inline">\(c_j=-1\)</span>이고 나머지 <span class="math inline">\(c_l=0\)</span>인 경우이다.</p>
<p>이렇게 관심있는 모수들의 선형조합 <span class="math inline">\(\psi\)</span>을 <strong>선형식(linear combination)</strong>이라고 부른다.</p>
<p><span id="eq-linear"><span class="math display">\[
\psi = c_1 \alpha_1 + c_2 \alpha_2 + \dots + c_a \alpha_a
\tag{4.9}\]</span></span></p>
<p>선형식 <a href="#eq-linear" class="quarto-xref">식&nbsp;<span>4.9</span></a> 에서 주어진 <strong>계수들의 합이 0 인 선형식을 특별히 대비(contrast)</strong>라고 한다.</p>
<p><span id="eq-contrast"><span class="math display">\[
C = c_1 \alpha_1 + c_2 \alpha_2 + \dots + c_a \alpha_a, \quad \sum_{i=1}^a c_i =0
\tag{4.10}\]</span></span></p>
<p>이러한 대비는 계수의 합이 0 이므로 각 처리 효과들을 다양하게 비교하는데 사용될 수 있다. 가설 <a href="#eq-hypo0" class="quarto-xref">식&nbsp;<span>4.5</span></a> , <a href="#eq-hypo1" class="quarto-xref">식&nbsp;<span>4.6</span></a> , <a href="#eq-hypo2" class="quarto-xref">식&nbsp;<span>4.7</span></a> 에 나타난 계수들 <span class="math inline">\(c_i\)</span> 들은 모두 더하면 0이므로 대비라고 부른다.</p>
</section>
<section id="추론" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="추론"><span class="header-section-number">4.2.2</span> 추론</h3>
<p>만약 선형식으로 주어진 가설 <a href="#eq-hypogeneral" class="quarto-xref">식&nbsp;<span>4.8</span></a> 를 검정하려면 다음과 같이 각 처리의 표본 평균들의 조합으로 이루어진 통계량을 사용할 수 있다.</p>
<p><span id="eq-linearest"><span class="math display">\[
\hat \psi = L_* = c_1 \bar x_{1.} + c_2 \bar x_{2.} + \dots + c_a \bar x_{a.}
\tag{4.11}\]</span></span></p>
<p>이제 식 <a href="#eq-linearest" class="quarto-xref">식&nbsp;<span>4.11</span></a> 의 선형 추정량 <span class="math inline">\(L_*\)</span> 의 평균과 분산을 구해보자</p>
<p><span class="math display">\[
\begin{aligned}
E(L_*) &amp; = E ( c_1 \bar x_{1.} + c_2 \bar x_{2.} + \dots + c_a \bar x_{a.} ) \\
  &amp; = c_1 E(\bar x_{1.}) + c_2 E(\bar x_{2.}) + \dots + c_a E(\bar  x_{a.}) \\
  &amp; = c_1 (\mu+ \alpha_1) + c_2 (\mu + \alpha_2) + \dots + c_a  (\mu + \alpha_a) \\
  &amp; = \mu \sum_{i=1}^a c_i + c_1 \alpha_1 + c_2  \alpha_2 + \dots + c_a   \alpha_a \\
  &amp; =  c_1 \alpha_1 + c_2  \alpha_2 + \dots + c_a   \alpha_a
\end{aligned}
\]</span></p>
<p>위의 유도에서 마지막 결과는 대비는 계수들의 합이 0 이라는 정의(<span class="math inline">\(\sum_{i=1}^a c_i =0\)</span>)를 이용한 것이다.</p>
<p><span class="math display">\[  
\begin{aligned}
V(L_*) &amp; = V ( c_1 \bar x_{1.} + c_2 \bar x_{2.} + \dots + c_a \bar x_{a.} ) \\
  &amp; = c_1^2 V(\bar x_{1.}) + c_2^2 V(\bar x_{2.}) + \dots + c_a^2 V(\bar  x_{a.}) \\
  &amp; = c_1^2 \frac{\sigma^2}{r} + c_2^2 \frac{\sigma^2}{r} + \dots + c_a^2  \frac{\sigma^2}{r} \\
  &amp; = \frac{\sigma^2}{r} \sum_{i=1}^a c_i^2
\end{aligned}
\]</span></p>
<p>이제 일원배치 모형 <a href="#eq-oneway2" class="quarto-xref">식&nbsp;<span>4.4</span></a> 에서 오차항 <span class="math inline">\(e_{ij}\)</span>가 정규분포 를 따른 다고 가정하였으므로 관측값들의 선형조합은 정규분포를 따른다. 따라서 식 <a href="#eq-linearest" class="quarto-xref">식&nbsp;<span>4.11</span></a> 의 선형 추정량 <span class="math inline">\(L_*\)</span>은 다음 같이 정규분포를 따른다.</p>
<p><span id="eq-lineardist"><span class="math display">\[
L_* \sim N \left ( \sum_i c_i \alpha_i, \frac{\sigma^2}{r} \sum_{i=1}^a c_i^2 \right )
\tag{4.12}\]</span></span></p>
<p>만약 선형식에 대한 가설 <a href="#eq-hypogeneral" class="quarto-xref">식&nbsp;<span>4.8</span></a> 이 참이라면 선형 추정량 <span class="math inline">\(L_*\)</span>의 평균은 0이 되고</p>
<p><span id="eq-lineardistnull"><span class="math display">\[
L_* \sim N \left (0,  \frac{\sigma^2}{r} \sum_{i=1}^a c_i^2\right )~~ \text{ under } H_0: ~  \sum_i c_i \alpha_i =0
\tag{4.13}\]</span></span></p>
<p>위에서 배운 카이제곱 분포에 대한 결과 <a href="#eq-chidist3" class="quarto-xref">식&nbsp;<span>4.3</span></a> 에 따라서 다음과 같은 결과를 얻는다.</p>
<p><span id="eq-lineardistnull2"><span class="math display">\[
\frac{L_*^2}{\tfrac{\sigma^2}{r} \sum_{i=1}^a c_i^2 } \sim \chi^2(1) ~~\text{ under } H_0: ~  \sum_i c_i \alpha_i =0
\tag{4.14}\]</span></span></p>
<p>분산분석에서 구한 오차제곱합 <span class="math inline">\(SSE\)</span>는 또한 다음과 같이 자유도가 <span class="math inline">\(n-a\)</span>인 카이제곱 분포를 따르며 선형식 <span class="math inline">\(L_*\)</span>과 독립이다 (독립의 이유에 대한 설명은 본 강의의 수준을 넘어서므로 생략한다.)</p>
<p><span id="eq-ssedist"><span class="math display">\[
\frac{SSE}{\sigma^2} \sim \chi^2(n-a)
\tag{4.15}\]</span></span></p>
<p>따라서 분포에 대한 두개의 결과 <a href="#eq-lineardistnull2" class="quarto-xref">식&nbsp;<span>4.14</span></a> 과 <a href="#eq-ssedist" class="quarto-xref">식&nbsp;<span>4.15</span></a> 를 이용해 보자. 귀무가설 <a href="#eq-hypogeneral" class="quarto-xref">식&nbsp;<span>4.8</span></a> 이 참인 경우 카이제곱 분포를 따르는 서로 독립인 독립변수의 비는 F-분포를 따른다.</p>
<p><span id="eq-ldist"><span class="math display">\[
F = \frac{  \left [ L_*^2 / \tfrac{\sigma^2}{r} \sum_{i=1}^a c_i^2 \right ] /1} { \left [ SSE/ \sigma^2  \right ] / (n-a)}
=  \left[ \frac{L_*^2}{\sum_{i=1}^a c_i^2/r } \right ] / MSE  \sim F(1, n-a) ~~\text{ under } H_0
\tag{4.16}\]</span></span></p>
<p>따라서 대비로 표현되는 산형식에 대한 가설검정 <a href="#eq-hypogeneral" class="quarto-xref">식&nbsp;<span>4.8</span></a> 은 식 <a href="#eq-ldist" class="quarto-xref">식&nbsp;<span>4.16</span></a> 의 <span class="math inline">\(F\)</span> 통계량이 자유도 <span class="math inline">\((1,n-a)\)</span>를 가진 F-분포의 상위 5% 백분위수보다 크면 귀무가설을 기각한다.</p>
</section>
<section id="표본합" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="표본합"><span class="header-section-number">4.2.3</span> 표본합</h3>
<p>위 <a href="#eq-linearest" class="quarto-xref">식&nbsp;<span>4.11</span></a> 의 선형 추정량 <span class="math inline">\(L_*\)</span> 은 각 처리에 대한 자료 합 <span class="math inline">\(T_1, T_2, \dots , T_a\)</span>로 다음과 같이 나타낼 수 있다. 교과서 7.1 식은 선형 추정량 <span class="math inline">\(L\)</span> 을 평균이 아닌 합으로 표시하고 있다.</p>
<p>각 처리에 대한 평균은 <span class="math inline">\(\bar x_{i.} = T_i / r\)</span>이므로</p>
<p><span class="math display">\[
\begin{aligned}
L  &amp; = c_1 T_1 + c_2 T_2 + \dots + c_a T_a  \\
  &amp; = r( c_1 \bar x_{1.} + c_2 \bar x_{2.} + \dots + c_a \bar x_{a.} ) \\
  &amp; =r L_*
\end{aligned}
\]</span></p>
<p>따라서 합으로 표시한 선형식 <span class="math inline">\(L\)</span>의 평균과 분산은 다음과 같다</p>
<p><span class="math display">\[
\begin{aligned}
E(L) &amp; =  E(rL) \\
   &amp; = r E(L) \\
   &amp; = r \sum_{i=1}^a c_i \alpha_i \\
V(L) &amp; = V(rL_*) \\
   &amp; = r^2 V(L_*) \\
   &amp; = r \sigma^2 \sum_{i=1}^a c_i^2
\end{aligned}
\]</span></p>
<p>카이제곱 분포에 대한 결과 <a href="#eq-chidist3" class="quarto-xref">식&nbsp;<span>4.3</span></a> 에 따라서 다음과 같은 결과를 얻는다.</p>
<p><span id="eq-lineardistnulltotal"><span class="math display">\[
\frac{L^2}{r\sigma^2  \sum_{i=1}^a c_i^2 } \sim \chi^2(1) ~~\text{ under } H_0: ~  \sum_i c_i \alpha_i =0
\tag{4.17}\]</span></span></p>
<p>여기서 유의할 점은 평균으로 구성된 선형식과 합으로 구성된 선형식으로 유도된 카이제곱 통계량은 동일하다. 따라서 대비에 나타나는 게수들에 상수를 곱해줘도 검정통계량의 변화는 없다.</p>
<p><span class="math display">\[ \frac{L^2}{ r\sigma^2  \sum_{i=1}^a c_i^2}  = \frac{r^2 L_*^2}{r\sigma^2  \sum_{i=1}^a c_i^2 } = \frac{L_*^2}{\tfrac{\sigma^2}{r} \sum_{i=1}^a c_i^2 } \]</span></p>
<p>이제 평균의 선형식과 같은 방법으로 합으로 표시된 선형식 <span class="math inline">\(L\)</span>에 대하여 다음과 같은 결과를 구할 수 있다.</p>
<p><span class="math display">\[
\begin{aligned}
F &amp; = \frac{  \left [ L^2 / r \sigma^2 \sum_{i=1}^a c_i^2 \right ] /1} { \left [ SSE/ \sigma^2  \right ] / (n-a)} \\
&amp; =  \left[ \frac{L^2}{r \sum_{i=1}^a c_i^2 } \right ] / MSE  \\
&amp; = SS_L / MSE \sim F(1, n-a) ~~\text{ under } H_0
\end{aligned}
\]</span></p>
<p>위에서 <span class="math inline">\(SS_L\)</span>은 교과서 7.2 식에서 정의된 통계량과 같다.</p>
</section>
</section>
<section id="직교-대비" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="직교-대비"><span class="header-section-number">4.3</span> 직교 대비</h2>
<section id="직교-대비의-정의" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="직교-대비의-정의"><span class="header-section-number">4.3.1</span> 직교 대비의 정의</h3>
<p>다음과 같이 처리그룹의 합으로 표시된 2개의 서로 다른 대비 <span class="math inline">\(C_1\)</span>과 <span class="math inline">\(C_2\)</span>를 고려하자.</p>
<p><span id="eq-contrast1"><span class="math display">\[
C_1 = c_1 T_1 + c_2 T_2 + \dots + c_a T_a, \quad \sum_{i=1}^a c_i =0
\tag{4.18}\]</span></span></p>
<p><span id="eq-contrast2"><span class="math display">\[
C_2 = d_1 T_1 + d_2 T_2 + \dots + d_a T_a, \quad \sum_{i=1}^a d_i =0
\tag{4.19}\]</span></span></p>
<p>서로 다른 두 대비에서 계수들의 내적이 0 이 되는 경우 <strong>두 대비가 직교(orthogonal)</strong>한다고 말한다.</p>
<p><span id="eq-ortho"><span class="math display">\[
\sum_{i=1}^a c_i d_i =0 \quad \rightarrow \text{ orthogonal constrast}
\tag{4.20}\]</span></span></p>
<p>대비가 서로 직교하면 그에 따른 두 제곱합 <span class="math inline">\(SS_{C_1}\)</span>과 <span class="math inline">\(SS_{C_2}\)</span>는 서로 독립이다.</p>
<p><span class="math display">\[ SS_{C_1} = \frac{C_1^2}{r\sum_i c_i^2 } \quad \sim_{indep.} \quad SS_{C_2} = \frac{C_2^2}{r\sum_i d_i^2 } \]</span></p>
<p>따라서 앞 절에서 배운 각 대비에 대한 가설을 검정할 수 있는 F-통계량도 독립이다.</p>
<p><span class="math display">\[ F_1 = \frac{SS_{C_1}}{MSE}  \quad \sim_{indep.} \quad F_2 = \frac{SS_{C_2}}{MSE} \]</span></p>
</section>
<section id="처리-제곱합의-분해" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="처리-제곱합의-분해"><span class="header-section-number">4.3.2</span> 처리 제곱합의 분해</h3>
<p>만약 요인 <span class="math inline">\(A\)</span>가 <span class="math inline">\(a\)</span>개의 수준을 가지면 이 요인에 대한 직교하는 대비를 <span class="math inline">\(a-1\)</span>개 만들 수 있다. 주의할 점은 직교하는 대비들는 유일하지 않다.</p>
<p>또한 각 대비 <span class="math inline">\(C_{i}\)</span>에 대한 제곱합은 자유도가 1인 카이제곱 분포를 따르며 서로 독립이다. 더 나아가 분산분석에서 요인 A에 대한 처리제곱합 <span class="math inline">\(SS_A\)</span>가 다은과 같이 분해된다.</p>
<p><span class="math display">\[ SS_A = SS_{C_1}  + SS_{C_2} + SS_{C_3} + \dots + SS_{C_{a-1}} \]</span></p>
</section>
<section id="대표적인-대비" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="대표적인-대비"><span class="header-section-number">4.3.3</span> 대표적인 대비</h3>
<section id="다항-대비" class="level4" data-number="4.3.3.1">
<h4 data-number="4.3.3.1" class="anchored" data-anchor-id="다항-대비"><span class="header-section-number">4.3.3.1</span> 다항 대비</h4>
<p>직교하는 대비들 중에 대표적인 예로 다항 대비(polynomial contrasts)가 있다. 다항 대비는 처리 수준의 간격이 일정한 경우 평균의 변화가 선형(linear)인지, 이차적(quadratic)인지, 더 나아가 <span class="math inline">\(k\)</span>차 다항식의 변화를 가지는지 검정할 수 있다.</p>
<p>다항대비의 계수들은 검정하고자 하는 변화의 추세가 강할 수록 대응하는 제곱합이 크게 되도록 설계되어 있다. 따라서 귀무가설에 대한 p-값이 크면 변화의 추세가 강하게 나타난다고 말할 수 있다.</p>
<p>예를 들어 3개의 수준에서 다음과 같이 2개의 다항 대비를 구할 수 있다. 아래 <code>R</code> 출력에 나오는 행렬의 각 열이 서로 직교하는 대비이다. 대비들의 계수의 제곱의 합이 1이 되도록(<span class="math inline">\(\sum_i c_i^2=1\)</span>) 정규화한 결과이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contr.poly</span>(<span class="dv">3</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                .L         .Q
[1,] -7.071068e-01  0.4082483
[2,] -9.073800e-17 -0.8164966
[3,]  7.071068e-01  0.4082483</code></pre>
</div>
</div>
<p>첫 번째 열이 선형 대비(linear contrast)로 계수는 다음과 같다.</p>
<p><span class="math display">\[ c_1= - \frac{1}{\sqrt{2}}, \quad c_2 =0 \quad c_3= \frac{1}{\sqrt{2}} \]</span></p>
<p>선형 대비를 그림으로 그려보면 다음과 같다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">contr.poly</span>(<span class="dv">3</span>)[,<span class="dv">1</span>]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y1 )</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,y1,<span class="at">cex=</span><span class="dv">2</span>, <span class="at">pch =</span><span class="dv">3</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="contrast_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>두 번째 열은 이차 대비(quadratic contrast)로 계수는 다음과 같다.</p>
<p><span class="math display">\[ c_1=  \frac{1}{\sqrt{6}}, \quad c_2 = - \frac{2}{\sqrt{6}} \quad c_3=  \frac{1}{\sqrt{6}} \]</span> 이차 대비를 그림으로 그려보면 다음과 같다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">contr.poly</span>(<span class="dv">3</span>)[,<span class="dv">2</span>]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y2 )</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x,y2,<span class="at">cex=</span><span class="dv">2</span>, <span class="at">pch =</span><span class="dv">3</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="contrast_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>다음과 같이 수준의 개수가 <span class="math inline">\(5\)</span>인 경우 4차 다항대비를 구해준다. 함수 <code>contr.poly(k)</code>는 <span class="math inline">\(k-1\)</span>차 다항 대비까지 구해준다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contr.poly</span>(<span class="dv">5</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                .L         .Q            .C         ^4
[1,] -6.324555e-01  0.5345225 -3.162278e-01  0.1195229
[2,] -3.162278e-01 -0.2672612  6.324555e-01 -0.4780914
[3,] -3.288380e-17 -0.5345225  9.637305e-17  0.7171372
[4,]  3.162278e-01 -0.2672612 -6.324555e-01 -0.4780914
[5,]  6.324555e-01  0.5345225  3.162278e-01  0.1195229</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="교과서-예제-7.1" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="교과서-예제-7.1"><span class="header-section-number">4.4</span> 교과서 예제 7.1</h2>
<p>교과서 예제 7.1 에서 제조회사에 대한 비교를 하는 경우 요인의 개수가 3개이므로 2개의 직교 대비를 이용한다.</p>
<p>예제 7.1 에서 제조회사에 대한 비교를 하는 경우 이용한 대비의 계수는 다음과 같다.</p>
<p><span class="math display">\[ c_1= 1, ~~ c_2=1, ~~ c_3 = -2 \]</span> <span class="math display">\[ d_1= 1, ~~d_2=-1, ~~ d_3= 0 \]</span></p>
<section id="이원배치-자료" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="이원배치-자료"><span class="header-section-number">4.4.1</span> 이원배치 자료</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/slide01.png" class="img-fluid figure-img"></p>
<figcaption>이원배치 자료</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">18</span>,<span class="dv">25</span>,<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">14</span>,<span class="dv">6</span>,<span class="dv">15</span>,<span class="dv">18</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"A1"</span>, <span class="st">"A2"</span>,<span class="st">"A3"</span>), <span class="at">each=</span><span class="dv">3</span>)))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>,<span class="st">"B3"</span>), <span class="dv">3</span>)))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(A,B,y)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   A  B  y
1 A1 B1 11
2 A1 B2 18
3 A1 B3 25
4 A2 B1  1
5 A2 B2  6
6 A2 B3 14
7 A3 B1  6
8 A3 B2 15
9 A3 B3 18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x =</span> A , <span class="at">y =</span> y) ) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>()</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="contrast_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span>  <span class="fu">ggplot</span>( <span class="fu">aes</span>(<span class="at">x =</span> B , <span class="at">y =</span> y) ) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>()</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="contrast_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="분산분석표" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="분산분석표"><span class="header-section-number">4.4.2</span> 분산분석표</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/slide02.png" class="img-fluid figure-img"></p>
<figcaption>분산분석표</figcaption>
</figure>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fm1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y<span class="sc">~</span>A<span class="sc">+</span>B, <span class="at">data=</span>df)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fm1)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
A            2    182      91    45.5 0.001773 ** 
B            2    254     127    63.5 0.000932 ***
Residuals    4      8       2                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="직교대비에-대한-제곱합의-분해" class="level3" data-number="4.4.3">
<h3 data-number="4.4.3" class="anchored" data-anchor-id="직교대비에-대한-제곱합의-분해"><span class="header-section-number">4.4.3</span> 직교대비에 대한 제곱합의 분해</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/slide03.png" class="img-fluid figure-img"></p>
<figcaption>제곱합의 분해</figcaption>
</figure>
</div>
</section>
<section id="직교대비에-대한-검정" class="level3" data-number="4.4.4">
<h3 data-number="4.4.4" class="anchored" data-anchor-id="직교대비에-대한-검정"><span class="header-section-number">4.4.4</span> 직교대비에 대한 검정</h3>
<section id="요인-a-제조-회사에-대한-직교-대비" class="level4" data-number="4.4.4.1">
<h4 data-number="4.4.4.1" class="anchored" data-anchor-id="요인-a-제조-회사에-대한-직교-대비"><span class="header-section-number">4.4.4.1</span> 요인 A: 제조 회사에 대한 직교 대비</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 직교 대비 계수 설정</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="sc">-</span><span class="dv">2</span>) <span class="co"># 국산 대 외제</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># 자사 대 국내사</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#직교대비 행렬 생성  </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>matA <span class="ot">&lt;-</span> <span class="fu">cbind</span>(c1,c2)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>matA</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     c1 c2
[1,]  1  1
[2,]  1 -1
[3,] -2  0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인에 대한 대비 지정</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df<span class="sc">$</span>A) <span class="ot">&lt;-</span> matA</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 직교대비에 대한 검정 </span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>fm1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y<span class="sc">~</span>A<span class="sc">+</span>B, <span class="at">data=</span>df) <span class="co"># 직교대비 지정한 후에 다시 분산분석을 해주어야 한다.</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(fm1 , <span class="at">split=</span><span class="fu">list</span>(<span class="at">A=</span><span class="fu">list</span>(<span class="st">"국산 대 외제"</span><span class="ot">=</span><span class="dv">1</span>, <span class="st">"자사 대 국내사"</span> <span class="ot">=</span> <span class="dv">2</span>))) </span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
A                    2  182.0    91.0   45.50 0.001773 ** 
  A: 국산 대 외제    1    0.5     0.5    0.25 0.643330    
  A: 자사 대 국내사  1  181.5   181.5   90.75 0.000678 ***
B                    2  254.0   127.0   63.50 0.000932 ***
Residuals            4    8.0     2.0                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="요인-b-성형온도에-대한-직교-대비" class="level4" data-number="4.4.4.2">
<h4 data-number="4.4.4.2" class="anchored" data-anchor-id="요인-b-성형온도에-대한-직교-대비"><span class="header-section-number">4.4.4.2</span> 요인 B: 성형온도에 대한 직교 대비</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 요인에 대한 대비 지정</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">contrasts</span>(df<span class="sc">$</span>B) <span class="ot">&lt;-</span> <span class="fu">contr.poly</span>(<span class="dv">3</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 직교대비에 대한 검정 </span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>fm1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y<span class="sc">~</span>A<span class="sc">+</span>B, <span class="at">data=</span>df) <span class="co"># 직교대비 지정한 후에 다시 분산분석을 해주어야 한다.</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fm1 , <span class="at">split=</span><span class="fu">list</span>(<span class="at">B=</span><span class="fu">list</span>(<span class="st">"선형"</span><span class="ot">=</span><span class="dv">1</span>, <span class="st">"이차"</span> <span class="ot">=</span> <span class="dv">2</span>))) </span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
A            2  182.0    91.0   45.50 0.001773 ** 
B            2  254.0   127.0   63.50 0.000932 ***
  B: 선형    1  253.5   253.5  126.75 0.000355 ***
  B: 이차    1    0.5     0.5    0.25 0.643330    
Residuals    4    8.0     2.0                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="두-요인을-모두-나타내는-분산분석" class="level3" data-number="4.4.5">
<h3 data-number="4.4.5" class="anchored" data-anchor-id="두-요인을-모두-나타내는-분산분석"><span class="header-section-number">4.4.5</span> 두 요인을 모두 나타내는 분산분석</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fm1 <span class="ot">&lt;-</span> <span class="fu">aov</span>(y<span class="sc">~</span>A<span class="sc">+</span>B, <span class="at">data=</span>df) <span class="co"># 직교대비 지정한 후에 다시 분산분석을 해주어야 한다.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fm1 , <span class="at">split=</span><span class="fu">list</span>( <span class="at">A=</span><span class="fu">list</span>(<span class="st">"국산 대 외제"</span><span class="ot">=</span><span class="dv">1</span>, <span class="st">"자사 대 국내사"</span> <span class="ot">=</span> <span class="dv">2</span>), <span class="at">B=</span><span class="fu">list</span>(<span class="st">"선형"</span><span class="ot">=</span><span class="dv">1</span>, <span class="st">"이차"</span> <span class="ot">=</span> <span class="dv">2</span>))) </span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    
A                    2  182.0    91.0   45.50 0.001773 ** 
  A: 국산 대 외제    1    0.5     0.5    0.25 0.643330    
  A: 자사 대 국내사  1  181.5   181.5   90.75 0.000678 ***
B                    2  254.0   127.0   63.50 0.000932 ***
  B: 선형            1  253.5   253.5  126.75 0.000355 ***
  B: 이차            1    0.5     0.5    0.25 0.643330    
Residuals            4    8.0     2.0                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../images/slide04.png" class="img-fluid figure-img"></p>
<figcaption>직교대비에 대한 분산분석표</figcaption>
</figure>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../qmd/block.html" class="pagination-link" aria-label="블록설계, 라틴정방설계와 분할법">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">블록설계, 라틴정방설계와 분할법</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../qmd/twolevels.html" class="pagination-link" aria-label="2수준 요인배치법">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">2수준 요인배치법</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>