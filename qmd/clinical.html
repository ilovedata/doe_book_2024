<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ko" xml:lang="ko"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>실험계획법 2024 강의 노트 - 8&nbsp; 의학연구에서의 실험계획법</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../references.html" rel="next">
<link href="../qmd/response.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "일치 없음",
    "search-matching-documents-text": "일치된 문서",
    "search-copy-link-title": "검색 링크 복사",
    "search-hide-matches-text": "추가 검색 결과 숨기기",
    "search-more-match-text": "추가 검색결과",
    "search-more-matches-text": "추가 검색결과",
    "search-clear-button-title": "제거",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "취소",
    "search-submit-button-title": "검색",
    "search-label": "검색"
  }
}</script>
<script type="text/javascript">
 window.MathJax = {
  tex: {
    macros: {
    RR: '{\\mathbb R}',                    // a simple string replacement
    hatmat:'{\\pmb X ({\\pmb X}^t {\\pmb X} )^{-1} {\\pmb X}^t}',
    bold: ['\\boldsymbol{#1}',1] ,     // this macro has one parameter
    pardiff: ['\\frac{\\partial#2}{\\partial#1}', 2, 'x'], // this macro has an optional parameter that defaults to 'x'
    pardifftwo: ['\\frac{\\partial#1}{\\partial#2}', 2]
  },
  environments: {
  braced: ["\\left\\{", "\\right\\}"]
  }
 }
};
</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../qmd/clinical.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">의학연구에서의 실험계획법</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="사이드바 전환" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">실험계획법 2024 강의 노트</a> 
        <div class="sidebar-tools-main">
    <a href="../실험계획법-2024-강의-노트.pdf" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="검색"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">서론</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/oneway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">일원배치법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/twoway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">이원배치법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/block.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">블록설계, 라틴정방설계와 분할법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/contrast.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">대비</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/twolevels.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">2수준 요인배치법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/twolevelscomf.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">2수준 요인배치법 - 교락법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/response.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">반응표면 분석</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/clinical.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">의학연구에서의 실험계획법</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="토글 섹션">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/visual.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title"><code>R</code>을 이용한 자료의 시각화 비교</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">일원배치 모형과 최소제곱법</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/raneff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">혼합 모형</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../qmd/comfound.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">교락</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">목차</h2>
   
  <ul>
  <li><a href="#공분산분석" id="toc-공분산분석" class="nav-link active" data-scroll-target="#공분산분석"><span class="header-section-number">8.1</span> 공분산분석</a>
  <ul class="collapse">
  <li><a href="#공분산-분석의-개요" id="toc-공분산-분석의-개요" class="nav-link" data-scroll-target="#공분산-분석의-개요"><span class="header-section-number">8.1.1</span> 공분산 분석의 개요</a></li>
  <li><a href="#공분산분석의-모형" id="toc-공분산분석의-모형" class="nav-link" data-scroll-target="#공분산분석의-모형"><span class="header-section-number">8.1.2</span> 공분산분석의 모형</a></li>
  <li><a href="#모수의-추정과-가설-검정" id="toc-모수의-추정과-가설-검정" class="nav-link" data-scroll-target="#모수의-추정과-가설-검정"><span class="header-section-number">8.1.3</span> 모수의 추정과 가설 검정</a></li>
  <li><a href="#예제-혈압-강하를-위한-임상-실험" id="toc-예제-혈압-강하를-위한-임상-실험" class="nav-link" data-scroll-target="#예제-혈압-강하를-위한-임상-실험"><span class="header-section-number">8.1.4</span> 예제: 혈압 강하를 위한 임상 실험</a></li>
  </ul></li>
  <li><a href="#임상살험의-목적" id="toc-임상살험의-목적" class="nav-link" data-scroll-target="#임상살험의-목적"><span class="header-section-number">8.2</span> 임상살험의 목적</a>
  <ul class="collapse">
  <li><a href="#임상실험의-목적-우월성-동등성-비열등성" id="toc-임상실험의-목적-우월성-동등성-비열등성" class="nav-link" data-scroll-target="#임상실험의-목적-우월성-동등성-비열등성"><span class="header-section-number">8.2.1</span> 임상실험의 목적: 우월성, 동등성, 비열등성</a></li>
  <li><a href="#통계적-가설" id="toc-통계적-가설" class="nav-link" data-scroll-target="#통계적-가설"><span class="header-section-number">8.2.2</span> 통계적 가설</a></li>
  <li><a href="#통계적-검정-절차---우월성" id="toc-통계적-검정-절차---우월성" class="nav-link" data-scroll-target="#통계적-검정-절차---우월성"><span class="header-section-number">8.2.3</span> 통계적 검정 절차 - 우월성</a></li>
  <li><a href="#통계적-검정-절차---비열등성" id="toc-통계적-검정-절차---비열등성" class="nav-link" data-scroll-target="#통계적-검정-절차---비열등성"><span class="header-section-number">8.2.4</span> 통계적 검정 절차 - 비열등성</a></li>
  <li><a href="#통계적-검정-절차---동등성" id="toc-통계적-검정-절차---동등성" class="nav-link" data-scroll-target="#통계적-검정-절차---동등성"><span class="header-section-number">8.2.5</span> 통계적 검정 절차 - 동등성</a></li>
  <li><a href="#동등성-검정의-size-와-유의수준" id="toc-동등성-검정의-size-와-유의수준" class="nav-link" data-scroll-target="#동등성-검정의-size-와-유의수준"><span class="header-section-number">8.2.6</span> 동등성 검정의 Size 와 유의수준</a></li>
  </ul></li>
  <li><a href="#교차실험과-동등성-검정" id="toc-교차실험과-동등성-검정" class="nav-link" data-scroll-target="#교차실험과-동등성-검정"><span class="header-section-number">8.3</span> 교차실험과 동등성 검정</a>
  <ul class="collapse">
  <li><a href="#생체이용률bioavailability" id="toc-생체이용률bioavailability" class="nav-link" data-scroll-target="#생체이용률bioavailability"><span class="header-section-number">8.3.1</span> 생체이용률(Bioavailability)</a></li>
  <li><a href="#약품-주성분의-생체이용률의-평균적-변화" id="toc-약품-주성분의-생체이용률의-평균적-변화" class="nav-link" data-scroll-target="#약품-주성분의-생체이용률의-평균적-변화"><span class="header-section-number">8.3.2</span> 약품 주성분의 생체이용률의 평균적 변화</a></li>
  <li><a href="#생물학적동등성의-정의-fda-과-kfda" id="toc-생물학적동등성의-정의-fda-과-kfda" class="nav-link" data-scroll-target="#생물학적동등성의-정의-fda-과-kfda"><span class="header-section-number">8.3.3</span> 생물학적동등성의 정의: FDA 과 KFDA</a></li>
  <li><a href="#생물학적동등성-실험의-설계" id="toc-생물학적동등성-실험의-설계" class="nav-link" data-scroll-target="#생물학적동등성-실험의-설계"><span class="header-section-number">8.3.4</span> 생물학적동등성 실험의 설계</a></li>
  <li><a href="#교차실험에-대한-통계적-모형" id="toc-교차실험에-대한-통계적-모형" class="nav-link" data-scroll-target="#교차실험에-대한-통계적-모형"><span class="header-section-number">8.3.5</span> 교차실험에 대한 통계적 모형</a></li>
  <li><a href="#평균적-생물학적동등성에-대한-가설" id="toc-평균적-생물학적동등성에-대한-가설" class="nav-link" data-scroll-target="#평균적-생물학적동등성에-대한-가설"><span class="header-section-number">8.3.6</span> 평균적 생물학적동등성에 대한 가설</a></li>
  <li><a href="#신뢰구간을-이용한-평균적-생물학적동등성-검정" id="toc-신뢰구간을-이용한-평균적-생물학적동등성-검정" class="nav-link" data-scroll-target="#신뢰구간을-이용한-평균적-생물학적동등성-검정"><span class="header-section-number">8.3.7</span> 신뢰구간을 이용한 평균적 생물학적동등성 검정</a></li>
  <li><a href="#개의-단측검정을-이용한-방법" id="toc-개의-단측검정을-이용한-방법" class="nav-link" data-scroll-target="#개의-단측검정을-이용한-방법"><span class="header-section-number">8.3.8</span> 2개의 단측검정을 이용한 방법</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">의학연구에서의 실험계획법</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="공분산분석" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="공분산분석"><span class="header-section-number">8.1</span> 공분산분석</h2>
<p>의학연구에서는 치료법이나 약물의 효과를 알아보기 위한 다양한 실험이 진행된다.</p>
<p>치료법이나 약품의 효과에 대하여 기초 연구(화학실험, 동물실험 등)가 어느 정도 진행되어 기대되는 효능이 있으며 큰 부작용이 없다고 판단되면 인간에게 치료법을 적용하거나 약품을 사용하는 임상실험(clinical trial)을 진행햔다.</p>
<p>임상실험은 많은 경우 <strong>병렬 계획(parallel design)</strong>에 의거한 일원배치법을 사용한다.</p>
<p><img src="../images/parallel.png" class="img-fluid" alt="병렬계획"> <a href="https://www.cancer.gov/about-cancer/treatment/clinical-trials/what-are-trials/randomization/clinical-trial-randomization-infographic">그림 출처</a></p>
<p>임상실험에서 요인은 치료 방법(treatmanet)이며 보통의 경우 2개의 수준를 가진다. 두 개의 수준 중 하나는 실험자가 연구대상으로 고려한 효과가 기대되는 치료/약품(active)이며 다른 하나의 수준은 제어 수준(control)이다. 임상실험에서는 대부분의 경우 효과가 있는 치료나 약품을 적용하지 않아도 <strong>위약효과(placebo effect)</strong>가 나타나기 때문에 실험자가 사용하려고 하는 치료법의 효과는 언제나 제어군에서 나타난 효과와의 차이로 파악해야 한다.</p>
<p>병렬 계획은 환자가 임의로 선택된 하나의 치료/약품만 받는 실험을 말한다. 참고로 뒤에서 살펴보겠지만 환자가 2개 이상의 치료을 받는 교차실험(crossover design)도 있다.</p>
<section id="공분산-분석의-개요" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="공분산-분석의-개요"><span class="header-section-number">8.1.1</span> 공분산 분석의 개요</h3>
<p>많은 임상 실험에서는 실험의 질과 수준이 실제 환자를 치료하는 환경과 동일하게 유지하는 것을 원칙으로 한다. 따라서 임상실험은 동장이나 연구실에서 수행하는 매우 정교하게 통제된 실험과 다르게 치료방법 외의 다양한 요인들이 영향을 미치게 된다. 이러한 다양한 요인들은 맹검화(blinding) 등 다양한 실험 기법을 사용하여 통제된다.</p>
<p>다양한 요인의 영향을 통제하려는 시도에도 불구하고 대표적으로 실험의 결과에 영향을 미치는 요인은 환자의 초기 상태(baseline)과 기관/병원(center/hospital effect)이다. 임상실험에 참가하는 환자들은 약품을 처리받기 전의 상태가 모두 다르기 때문에 처리의 효과뿐만이 아니라 환자의 초기 상태도 최종 반응값에 영향을 미친다. 또한 대부분의 임상실험은 여러 개의 병원(또는 지역, 나라)에서 동시에 실행되므로 병원, 지역, 국가의 특성에 따라서 임상시험의 결과에 영향을 미친다.</p>
<p>이렇게 실험에서 주요하게 고려하는 요인인 아닌 다른 요인이 영향을 미친다고 판단될 때 그 요인을 <strong>공변량 (covariate)</strong> 라고 부르며 공변량을 모형에 포함시키는 분석을 <strong>공분산분석(Analysis of Covariance; ANCOVA)</strong>라고 부른다.</p>
<p>공변량의 형태는 보통 실험 단위가 가지고 있는 특성이나 실험자가 가진 특성을 반영한다. 예를 들어 다음과 같은 공변량의 형태가 있다.</p>
<ul>
<li>교육 방법을 비교하는 실험에서 학생들이 가진 학습 역량</li>
<li>혈압 강하를 위한 약품에 대한 실험에서 임상 참가 전 환자의 혈압과 나이</li>
<li>천식에 대한 약품 실험이 여러 국가에서 실행될때 국가의 효과</li>
<li>암을 진단하는 방법에 대한 임상 실험이 다수의 병원에서 진행될 때 병원의 효과</li>
</ul>
<p>일반적으로 임상실험이나 관측연구에서는 관심이 있는 처리(treatment)나 요인(factor)뿐만 아니라 다른 요인들도 반응변수에 영향을 미친다. 이러한 다른 요인들의 영향을 제거하기 위한 방법은 여러가지가 있지만 실험인 경우 임의화 방법(randomization)으로 그 영향을 상쇄시킬 수 도 있고 관측연구인 경우에는 사례-대조연구 방법을 이용하여 그 영향을 최소화하려고 노력을 한다. 하지만 다양한 통제 방법에도 불구하고 여러 가지 변수들이 반응변수에 영향을 미친다. 이러한 경우에 중요한 요인을 모형에 포함시켜서 그 영향을 반영하고 동시에 자료의 변동을 부가적으로 설명해주는 방법이 공분산 분석이다.</p>
</section>
<section id="공분산분석의-모형" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="공분산분석의-모형"><span class="header-section-number">8.1.2</span> 공분산분석의 모형</h3>
<p>실험에서 공변량은 연속형 변수일 수도 있고 범주형일 수 도 있다. 만약 공변량이 범주형 변수인 경우 분석의 방법은 이원배치 분산분석과 매우 유사하다. 이 절에서는 공변량은 연속형 변수라고 가정하고 분석 방법을 논의할 것이다. 또한 공변량이 2개 이상인 경우도 있지만 이 절에서는 공변량이 하나인 경우만 고려한다.</p>
<p>공분산분석의 모형은 일원배치 분산분석 모형(처리의 수는 <span class="math inline">\(a\)</span>개, 반복수는 <span class="math inline">\(r\)</span>)에 공변량 <span class="math inline">\(x\)</span>의 효과를 다음과 같이 더해주는 것이다.</p>
<p><span id="eq-ancovamodel1"><span class="math display">\[
y_{ij} = \mu + \alpha_i + \beta(x_{ij} - \bar x_{..}) + e_{ij},
\quad i=1,2,\dots,a, ~~ j=1,2,\dots,r
\tag{8.1}\]</span></span></p>
<p>모형 <a href="#eq-ancovamodel1" class="quarto-xref">식&nbsp;<span>8.1</span></a> 에서 <span class="math inline">\(x_{ij}\)</span>는 관측값 <span class="math inline">\(y_{ij}\)</span>의 공변량이며 이를 중심화(centering)하여 회귀모형의 독립변수로 표현한다. 모형 <a href="#eq-ancovamodel1" class="quarto-xref">식&nbsp;<span>8.1</span></a> 에서 <span class="math inline">\(\bar x_{..} = sum_i sum_j x_{ij}/(ar)\)</span> 로 공변량 값의 전체 평균이다.</p>
<p>참고로 공변량을 중심화 하지 않는 모형은 다음과 같이 표현할 수 있다.</p>
<p><span class="math display">\[
\begin{aligned}
y_{ij} &amp; = \mu + \alpha_i + \beta(x_{ij} - \bar x_{..}) + e_{ij} \\
  &amp; = \beta_0 + \alpha_i + \beta x_{ij} + e_{ij} \\
  &amp; = \beta_{0i} + \beta x_{ij} + e_{ij}
\end{aligned}
\]</span></p>
</section>
<section id="모수의-추정과-가설-검정" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="모수의-추정과-가설-검정"><span class="header-section-number">8.1.3</span> 모수의 추정과 가설 검정</h3>
<p>모형 <a href="#eq-ancovamodel1" class="quarto-xref">식&nbsp;<span>8.1</span></a> 에서 각 모수의 추정은 최소제곱법을 이용하여 추정하며 부가조건 <span class="math inline">\(\sum_i \alpha_i =0\)</span> 을 이용하면 다음과 같은 추정량을 얻을 수 있다</p>
<p><span class="math display">\[
\begin{aligned}
\hat \mu &amp; = \bar y_{..} \\
\hat \alpha_i &amp; =\bar y_{i.} - \bar y_{..} -\hat \beta(\bar x_{i.} -\bar x_{..}) \\
\hat \beta &amp; =  \frac{ \sum_i \sum_j (x_{ij} - \bar x_{i.})(y_{ij}-\bar y_{i.})}{\sum_i \sum_j (x_{ij} - \bar x_{i.})^2}
\end{aligned}
\]</span></p>
<p>ANCOVA 모형에서는 다음과 같은 두 가지 가설을 검정할 수 있다.</p>
<p>ANOVA 모형에서와 같이 각 그룹의 평균에 대한 검정을 할 수 있고</p>
<p><span class="math display">\[
H_0: \alpha_1 = \alpha_2 =...=\alpha_a =0  \quad \text{vesus} \quad H_1: \text{ not } H_0
\]</span></p>
<p>또한 공변량의 효과에 대한 검정도 할 수 있다.</p>
<p><span id="eq-hypoancova"><span class="math display">\[
H_0: \beta =0  \quad \text{vesus} \quad H_1: \beta \ne 0
\tag{8.2}\]</span></span></p>
</section>
<section id="예제-혈압-강하를-위한-임상-실험" class="level3" data-number="8.1.4">
<h3 data-number="8.1.4" class="anchored" data-anchor-id="예제-혈압-강하를-위한-임상-실험"><span class="header-section-number">8.1.4</span> 예제: 혈압 강하를 위한 임상 실험</h3>
<p>공분산분석의 개념을 이해하기 위한 예제로서 혈압 강하를 위한 임상 실험에서 얻는 자료를 분석해 보자.</p>
<p>자료는 <span class="citation" data-cites="chen2017clinical">(<a href="../references.html#ref-chen2017clinical" role="doc-biblioref">Chen, Peace, 와/과 Zhang 2017</a>)</span> 에 나온 자료이며 화일 <a href="https://github.com/ilovedata/doe_book_2024/blob/main/data/dbp.txt">dbp.txt</a> 에 저장되어 있다.</p>
<p>혈압 강하를 위한 임상실험은 2개의 처리 집단(<code>A</code> 와 <code>B</code>) 로 각각 20명이 실험에 참가하였다. 약을 복용하기 전에 혈압을 측정하고(<code>DBP1</code>) 약을 복용한 후 한 달 간격으로 4번 측정을 하였다 (<code>DBP2</code>-<code>DBP5</code>).</p>
<p>최종적으로 관심있는 반응변수는 약품을 복용하기 전 혈압에서 4개월 후 혈압이 변화한 차이이다. 따라서 반응변수 <code>diff</code> 는 <code>DBP5</code>에서 <code>DBP1</code>을 뺀 값이다.</p>
<p>또한 공변량으로서 성별(<code>Sex</code>)과 연령(<code>Age</code>)를 측정하였다. 공분산분석에서는 공변량으로 연령을 고려할 것이다.</p>
<p>다음은 화일에서 자료를 읽고 정리하는 프로그램이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dpb <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data"</span>,<span class="st">"dbp.txt"</span>), <span class="at">sep=</span><span class="st">""</span>, <span class="at">header=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> dpb <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">diff =</span> DBP5 <span class="sc">-</span>DBP1)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Subject TRT DBP1 DBP2 DBP3 DBP4 DBP5 Age Sex diff
1       1   A  114  115  113  109  105  43   F   -9
2       2   A  116  113  112  103  101  51   M  -15
3       3   A  119  115  113  104   98  48   F  -21
4       4   A  115  113  112  109  101  42   F  -14
5       5   A  116  112  107  104  105  49   M  -11
6       6   A  117  112  113  104  102  47   M  -15</code></pre>
</div>
</div>
<p>처리 그룹간에 시간에 따른 혈압의 평균적인 변화를 그름으로 살펴보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">select</span>(Subject, TRT, DBP1, DBP2, DBP3, DBP4, DBP5) <span class="sc">%&gt;%</span> <span class="fu">gather</span>(TimePoint, dbp,DBP1, DBP2, DBP3, DBP4, DBP5)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df1s <span class="ot">&lt;-</span> df1 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(TRT, TimePoint)  <span class="sc">%&gt;%</span>  <span class="fu">summarise</span>(<span class="at">meanDBP=</span><span class="fu">mean</span>(dbp))</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df1s<span class="sc">$</span>Month <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>df1s <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Month,  <span class="at">y =</span> meanDBP, <span class="at">colour =</span> TRT)) <span class="sc">+</span> <span class="fu">geom_line</span>() </span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clinical_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>이제 두 처리 그룹간에 혈압의 변화 <code>diff</code> 에 대하여 기초통계량으로 살펴보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dfs2 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(TRT)  <span class="sc">%&gt;%</span>  <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(diff), <span class="at">median=</span> <span class="fu">median</span>(diff), <span class="at">sd=</span><span class="fu">sd</span>(diff), <span class="at">min=</span><span class="fu">min</span>(diff), <span class="at">max=</span><span class="fu">max</span>(diff))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dfs2</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 6
  TRT    mean median    sd   min   max
  &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;
1 A     -15.2  -15    2.97   -21    -9
2 B      -4.8   -5.5  2.42    -8     1</code></pre>
</div>
</div>
<p>두 처리 그룹간에 혈압의 변화에 대하여 그림으로 살펴보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(TRT, diff)) <span class="sc">+</span>  <span class="fu">geom_boxplot</span>()</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clinical_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><code>A</code> 그룹이 <code>B</code> 그룹보다 평균적으로 혈압이 약 10 mmHg 더 감소하였다.</p>
<section id="분산분석" class="level4" data-number="8.1.4.1">
<h4 data-number="8.1.4.1" class="anchored" data-anchor-id="분산분석"><span class="header-section-number">8.1.4.1</span> 분산분석</h4>
<section id="공변량이-없는-일원배치법에서의-분산분석" class="level5" data-number="8.1.4.1.1">
<h5 data-number="8.1.4.1.1" class="anchored" data-anchor-id="공변량이-없는-일원배치법에서의-분산분석"><span class="header-section-number">8.1.4.1.1</span> 공변량이 없는 일원배치법에서의 분산분석</h5>
<p>우리는 아래와 같은 일원배치 실험계획에서 처리 효과에 대한 검정을 위한 분산분석표가 아래와 같이 주어지는 것을 배웠다.</p>
<p><span class="math display">\[ y_{ij} = \mu + \alpha_i + e_{ij} \]</span></p>
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 7%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: right;">제곱합</th>
<th style="text-align: right;">자유도</th>
<th style="text-align: right;">평균제곱합</th>
<th style="text-align: center;"><span class="math inline">\(F_0\)</span></th>
<th style="text-align: right;">p-값</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">처리</td>
<td style="text-align: right;"><span class="math inline">\(SS_A\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\phi_A = a-1\)</span></td>
<td style="text-align: right;"><span class="math inline">\(MS_A=SS_A/\phi_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_0=MS_A/MS_E\)</span></td>
<td style="text-align: right;"><span class="math inline">\(P[F(\phi_A, \phi_E) &gt; F_0  ]\)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">잔차</td>
<td style="text-align: right;"><span class="math inline">\(SS_E\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\phi_E=a(r-1)\)</span></td>
<td style="text-align: right;"><span class="math inline">\(MS_E=SS_E/\phi_E\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">총합</td>
<td style="text-align: right;"><span class="math inline">\(SS_T\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\phi_T =  ar-1\)</span></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>위의 분산분석표에서 다음과 같이 제곱합의 분해가 얻어진다.</p>
<p><span id="eq-ssdecomp1"><span class="math display">\[
SS_T = SS_A + SS_E
\tag{8.3}\]</span></span></p>
<p>혈압 자료에 처리 효과만 있는 일원배치법으로 분산분석표를 구해보자. 두 처리 집단 사이에 혈압의 변화에 대한 차이는 매우 유의하다. 참고로 가설 검정에 이용되는 F-값은 147.63 이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>lmres1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diff<span class="sc">~</span>TRT, <span class="at">data=</span>df)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lmaov1 <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmres1)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>lmaov1</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: diff
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
TRT        1 1081.6 1081.60  147.63 1.169e-14 ***
Residuals 38  278.4    7.33                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="공변량이-있는-일원배치법에서의-분산분석" class="level5" data-number="8.1.4.1.2">
<h5 data-number="8.1.4.1.2" class="anchored" data-anchor-id="공변량이-있는-일원배치법에서의-분산분석"><span class="header-section-number">8.1.4.1.2</span> 공변량이 있는 일원배치법에서의 분산분석</h5>
<p>공변량이 포함된 모형 <a href="#eq-ancovamodel1" class="quarto-xref">식&nbsp;<span>8.1</span></a> 에 대한 분산분석표는 다음과 같이 주어진다.</p>
<table class="table">
<colgroup>
<col style="width: 17%">
<col style="width: 7%">
<col style="width: 18%">
<col style="width: 18%">
<col style="width: 11%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">요인</th>
<th style="text-align: right;">제곱합</th>
<th style="text-align: right;">자유도</th>
<th style="text-align: right;">평균제곱합</th>
<th style="text-align: center;"><span class="math inline">\(F_0\)</span></th>
<th style="text-align: right;">p-값</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">변량</td>
<td style="text-align: right;"><span class="math inline">\(SS_X\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\phi_X=1\)</span></td>
<td style="text-align: right;"><span class="math inline">\(MS_X=SS_X/\phi_X\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_X=MS_X/MS_E\)</span></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">처리</td>
<td style="text-align: right;"><span class="math inline">\(SS_A\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\phi_A = a-1\)</span></td>
<td style="text-align: right;"><span class="math inline">\(MS_A=SS_A/\phi_A\)</span></td>
<td style="text-align: center;"><span class="math inline">\(F_0=MS_A/MS_E\)</span></td>
<td style="text-align: right;"><span class="math inline">\(P[F(\phi_A, \phi_E) &gt; F_0  ]\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">잔차</td>
<td style="text-align: right;"><span class="math inline">\(SS'_E\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\phi_E=a(r-1)-1\)</span></td>
<td style="text-align: right;"><span class="math inline">\(MS'_E=SS'_E/\phi_E\)</span></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">총합</td>
<td style="text-align: right;"><span class="math inline">\(SS_T\)</span></td>
<td style="text-align: right;"><span class="math inline">\(\phi_T =  ar-1\)</span></td>
<td style="text-align: right;"></td>
<td style="text-align: center;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>이제 혈압 자료에 연령을 공변량으로 포함한 일원배치법으로 공분산분석표를 구해보자. 두 처리 집단 사이에 혈압의 변화에 대한 차이는 매우 유의하다. 참고로 가설 검정에 이용되는 F-값은 176.03 로서 공변량이 없는 경우(147.63)보다 크다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>lmres2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(diff<span class="sc">~</span>TRT <span class="sc">+</span> Age, <span class="at">data=</span>df)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>lmaov2 <span class="ot">&lt;-</span> <span class="fu">anova</span>(lmres2)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>lmaov2</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: diff
          Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
TRT        1 1081.60 1081.60 176.0395 1.228e-15 ***
Age        1   51.07   51.07   8.3119  0.006525 ** 
Residuals 37  227.33    6.14                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>공변량이 있는 경우 분산분석표에서 다음과 같이 제곱합의 분해가 얻어진다.</p>
<p><span id="eq-ssdecomp2"><span class="math display">\[
SS_T = SS_A + SS_X + SS'_E
\tag{8.4}\]</span></span></p>
<p>이제 공변량이 없는 경우의 제곱합의 분해 <a href="#eq-ssdecomp1" class="quarto-xref">식&nbsp;<span>8.3</span></a> 과 있는 경우의 분해 <a href="#eq-ssdecomp1" class="quarto-xref">식&nbsp;<span>8.3</span></a> 을 보면 공변량이 없는 경우의 오차제곱합이 두 개의 제곱합으로 분해되는 것을 알 수 있다.</p>
<p><span id="eq-anocvadecomp"><span class="math display">\[
SS_E = SS_X + SS'_E
\tag{8.5}\]</span></span></p>
<p>즉, 만약 반응변수와 공변량의 상관관계가 크면 공변량에 대한 제곱합 <span class="math inline">\(SS_X\)</span>가 커질 것이며 이는 공변량이 있는 모형에서 처리 효과를 검정하는 경우 사용되는 오차제곱합 <span class="math inline">\(SS'_E\)</span> 가 공변량이 없는 경우의 <span class="math inline">\(SS_E\)</span> 보다 작아지는 것을 알 수 있다.</p>
<p>결론적으로 반응변수와 공변량의 상관관계가 크면, 공변량을 포함하는 모형에서 처리 효과를 검정하는 <span class="math inline">\(F\)</span>-값이 공변량을 포함하지 않는 것보다 일반적으로 커지게 된다. 이는 공변량이 처리효과로 설명하지 못하는 변동 중의 일부를 설명하기 때문에 처리효과에 대한 검정력이 높아지게 된다.</p>
<p>공변량의 유무에 따른 제곱합의 분해의 차이를 그림으로 나타내면 다음과 같다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ssq1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">effect=</span><span class="fu">c</span>(<span class="st">"TRT"</span>, <span class="st">"Residuals"</span>), <span class="at">sumsquare=</span>lmaov1<span class="sc">$</span><span class="st">"Sum Sq"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ssq2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">effect=</span><span class="fu">c</span>(<span class="st">"TRT"</span>, <span class="st">"Age"</span>, <span class="st">"Residuals"</span>), <span class="at">sumsquare=</span>lmaov2<span class="sc">$</span><span class="st">"Sum Sq"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(ssq1<span class="sc">$</span>sumsquare, <span class="at">labels =</span> ssq1<span class="sc">$</span>effect, <span class="at">main=</span><span class="st">"ANOVA"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(ssq2<span class="sc">$</span>sumsquare, <span class="at">labels =</span> ssq2<span class="sc">$</span>effect, <span class="at">main =</span> <span class="st">"ANCOVA"</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clinical_files/figure-html/figures-side-1.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clinical_files/figure-html/figures-side-2.png" class="img-fluid figure-img" style="width:70.0%"></p>
</figure>
</div>
</div>
</div>
<p>참고로 공변량을 포함하는 모형에서 오차제곱합의 자유도는 포함하지 않는 모형보다 1개가 줄어든다. 이는 공변량에 의한 제곱합의 자유도 1개가 추가되기 때문이다.</p>
</section>
</section>
<section id="공분산분석-모형의-해석" class="level4" data-number="8.1.4.2">
<h4 data-number="8.1.4.2" class="anchored" data-anchor-id="공분산분석-모형의-해석"><span class="header-section-number">8.1.4.2</span> 공분산분석 모형의 해석</h4>
<p>이제 위에서 구한 공분산분석 모형 <a href="#eq-ancovamodel1" class="quarto-xref">식&nbsp;<span>8.1</span></a> 에 대한 추정식의 계수를 살펴보자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmres2)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm.default(formula = diff ~ TRT + Age, data = df)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.9039 -1.6516 -0.0091  1.1557  5.2299 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -6.78086    2.97236  -2.281  0.02838 *  
TRTB        10.13149    0.78936  12.835 3.38e-15 ***
Age         -0.17323    0.06009  -2.883  0.00653 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.479 on 37 degrees of freedom
Multiple R-squared:  0.8328,    Adjusted R-squared:  0.8238 
F-statistic: 92.18 on 2 and 37 DF,  p-value: 4.243e-15</code></pre>
</div>
</div>
<p>이제 처리 그룹(<code>A</code>, <code>B</code>)과 연령 간의 관계를 그림으로 그려보면 다음과 같이 나타낼 수 있다. 연령이 증가하면 혈압의 강화 효과가 점점 더 커지는 것을 알 수 있으며 통계적으로도 유의하다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(diff<span class="sc">~</span>Age,<span class="at">las=</span><span class="dv">1</span>,<span class="at">pch=</span><span class="fu">as.character</span>(TRT), df, <span class="at">xlab=</span><span class="st">"Age"</span>, <span class="at">ylab=</span><span class="st">"DBP Change"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lmres2<span class="sc">$</span>coef[<span class="dv">1</span>], lmres2<span class="sc">$</span>coef[<span class="dv">3</span>],<span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lmres2<span class="sc">$</span>coef[<span class="dv">1</span>]<span class="sc">+</span>lmres2<span class="sc">$</span>coef[<span class="dv">2</span>], lmres2<span class="sc">$</span>coef[<span class="dv">3</span>],<span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">4</span>)</span></code><button title="클립보드 복사" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="clinical_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="임상살험의-목적" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="임상살험의-목적"><span class="header-section-number">8.2</span> 임상살험의 목적</h2>
<section id="임상실험의-목적-우월성-동등성-비열등성" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="임상실험의-목적-우월성-동등성-비열등성"><span class="header-section-number">8.2.1</span> 임상실험의 목적: 우월성, 동등성, 비열등성</h3>
<ul>
<li>우월성 (superiority)
<ul>
<li>T is superior to S</li>
<li>Treatment T has more therapeutic effect than S.</li>
</ul></li>
<li>동등성(equivalence)
<ul>
<li>T is equivalent to S</li>
<li>Two treatments T and S have equal therapeutic effect.</li>
</ul></li>
<li>비열등성(noninferiority)
<ul>
<li>T is noninferior to S</li>
<li>Treatment T is not inferior to S (T is as effective as S)</li>
</ul></li>
</ul>
<p><img src="../images/equiv-meaning.png" class="img-fluid"></p>
<p>출처: <span class="citation" data-cites="walker2011understanding">Walker 와/과 Nowacki (<a href="../references.html#ref-walker2011understanding" role="doc-biblioref">2011</a>)</span></p>
</section>
<section id="통계적-가설" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="통계적-가설"><span class="header-section-number">8.2.2</span> 통계적 가설</h3>
<p>평균이 큰 것이 좋다고 가정하자.</p>
<ul>
<li>우월성 연구의 가설</li>
</ul>
<p><span class="math display">\[ H_0 : \mu_T = \mu_S  \quad \text{ vs. } \quad H_1: \mu_T \ne \mu_S   \]</span></p>
<ul>
<li><p>사실상 우월성 실험의 대립 가설은 <span class="math inline">\(H_1: \mu_T &gt; \mu_S\)</span> 이다.</p></li>
<li><p>우월성에 대한 가설을 아래와 같이 세울수도 있지만 거의 사용하지 않는다.</p></li>
</ul>
<p><span class="math display">\[ H_0 : \mu_T \le  \mu_S + \delta  \quad \text{ vs. } \quad H_1: \mu_T &gt; \mu_S +   \delta \]</span></p>
<ul>
<li><p><span class="math inline">\(\delta\)</span>는 margin 이라고 부르며 의학적(임상적)으로 우월한 차이를 보이는 치료 효과의 차이를 말한다.</p></li>
<li><p>동등성(equivalence)</p></li>
</ul>
<p><span class="math display">\[ H_0 : | \mu_T - \mu_S | \ge \delta \quad \text{ vs. } \quad H_1: | \mu_T - \mu_S| &lt; \delta \]</span></p>
<ul>
<li>비열등성(noninferiority)</li>
</ul>
<p><span class="math display">\[ H_0  : \mu_T \le  \mu_S - \delta  \quad \text{ vs. } \quad H_1: \mu_T &gt; \mu_S -   \delta \]</span></p>
</section>
<section id="통계적-검정-절차---우월성" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="통계적-검정-절차---우월성"><span class="header-section-number">8.2.3</span> 통계적 검정 절차 - 우월성</h3>
<ul>
<li>우월성 연구의 가설</li>
</ul>
<p><span class="math display">\[ H_0 : \mu_T = \mu_S  \quad \text{ vs. } \quad H_1: \mu_T \ne \mu_S   \]</span></p>
<ul>
<li><p>일반적인 t-검정 또는 z-검정을 사용</p></li>
<li><p>귀무가설의 기각 조건</p></li>
</ul>
<p><span class="math display">\[   \frac{\hat \mu_T - \hat \mu_S}{se(\hat \mu_T - \hat \mu_S)} &gt; c_{\alpha/2} \]</span> 또는</p>
<p><span class="math display">\[   (\hat \mu_T - \hat \mu_S) - c_{\alpha/2}  se(\hat \mu_T - \hat \mu_S) &gt; 0  \]</span></p>
<p><img src="../images/equiv-super.png" class="img-fluid"></p>
<p>출처: <span class="citation" data-cites="walker2011understanding">Walker 와/과 Nowacki (<a href="../references.html#ref-walker2011understanding" role="doc-biblioref">2011</a>)</span></p>
</section>
<section id="통계적-검정-절차---비열등성" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="통계적-검정-절차---비열등성"><span class="header-section-number">8.2.4</span> 통계적 검정 절차 - 비열등성</h3>
<ul>
<li>비열등성의 가설</li>
</ul>
<p><span class="math display">\[
H_0 : H_0 : \mu_T \le  \mu_S - \delta  \quad \text{ vs. } \quad H_1: \mu_T &gt; \mu_S -   \delta
\]</span> #{eq-noninf}</p>
<ul>
<li><p>일반적인 t-검정 또는 z-검정을 사용</p></li>
<li><p>귀무가설의 기각 조건</p></li>
</ul>
<p><span class="math display">\[   (\hat \mu_T - \hat \mu_S) - c_{\alpha} ~ se(\hat \mu_T - \hat \mu_S) &gt; -\delta  \]</span></p>
<p><img src="../images/equiv-inf.png" class="img-fluid"></p>
<p>출처: <span class="citation" data-cites="walker2011understanding">Walker 와/과 Nowacki (<a href="../references.html#ref-walker2011understanding" role="doc-biblioref">2011</a>)</span></p>
</section>
<section id="통계적-검정-절차---동등성" class="level3" data-number="8.2.5">
<h3 data-number="8.2.5" class="anchored" data-anchor-id="통계적-검정-절차---동등성"><span class="header-section-number">8.2.5</span> 통계적 검정 절차 - 동등성</h3>
<p>-동등성 가설</p>
<p><span id="eq-equihypo"><span class="math display">\[
H_0 : | \mu_T - \mu_S | \ge \delta \quad \text{ vs. } \quad H_1: | \mu_T - \mu_S| &lt; \delta
\tag{8.6}\]</span></span></p>
<ul>
<li><p>일반적인 t-검정 또는 z-검정이 아닌 <strong>the two one-sided test</strong>를 사용</p></li>
<li><p>가설 <a href="#eq-equihypo" class="quarto-xref">식&nbsp;<span>8.6</span></a> 의 귀무가설은 다음 두 개의 단측 귀무 가설의 합집합니다.</p></li>
</ul>
<p><span id="eq-twoequihypo"><span class="math display">\[
H_{01} :  \mu_T - \mu_S  \ge \delta \quad  \quad H_{02} :  \mu_T - \mu_S  \le  -\delta
\tag{8.7}\]</span></span></p>
<p>따라서 <a href="#eq-twoequihypo" class="quarto-xref">식&nbsp;<span>8.7</span></a> 에 있는 두 개의 가설이 모두 기각되면 <a href="#eq-equihypo" class="quarto-xref">식&nbsp;<span>8.6</span></a> 에 있는 동등성 가설을 기각할 수 있다.</p>
<ul>
<li><strong>the two one-sided test</strong>는 다음과 같은 두 조건이 만족되면 귀무가설을 기각한다.</li>
</ul>
<p><span class="math display">\[  
\frac{\hat \mu_T - \hat \mu_S - \delta}{se(\hat \mu_T - \hat \mu_S)} &lt; - c_{\alpha}
~~\text{ and }~~~ \frac{\hat \mu_T - \hat \mu_S + \delta}{se(\hat \mu_T - \hat \mu_S)} &gt; c_{\alpha}
\]</span></p>
<p>위의 귀무가설 기각 조건은 다음과 동일하다. 즉 <span class="math inline">\(100(1-2\alpha)\)</span>% 신뢰구간이 <span class="math inline">\((-\delta, \delta)\)</span> 안에 존재하면 귀무가설을 기각한다.</p>
<p><span class="math display">\[
-\delta &lt; (\hat \mu_T - \hat \mu_S) -  c_{\alpha} ~~se(\hat \mu_T - \hat \mu_S) &lt;
(\hat \mu_T - \hat \mu_S) + c_{\alpha}~~ se(\hat \mu_T - \hat \mu_S) &lt; \delta
\]</span></p>
<p><img src="../images/equiv-equiv.png" class="img-fluid"></p>
</section>
<section id="동등성-검정의-size-와-유의수준" class="level3" data-number="8.2.6">
<h3 data-number="8.2.6" class="anchored" data-anchor-id="동등성-검정의-size-와-유의수준"><span class="header-section-number">8.2.6</span> 동등성 검정의 Size 와 유의수준</h3>
<ul>
<li><span class="math inline">\(100(1-2\alpha)\)</span>% 신뢰구간을 이용하는 경우 검정의 Size 와 유의수준은 ? ( <span class="citation" data-cites="kang2008">Kang (<a href="../references.html#ref-kang2008" role="doc-biblioref">2008</a>)</span> 참조)</li>
</ul>
</section>
</section>
<section id="교차실험과-동등성-검정" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="교차실험과-동등성-검정"><span class="header-section-number">8.3</span> 교차실험과 동등성 검정</h2>
<section id="생체이용률bioavailability" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="생체이용률bioavailability"><span class="header-section-number">8.3.1</span> 생체이용률(Bioavailability)</h3>
<ul>
<li><p>the rate and extent to which the active ingredient is absorbed from a drug product and becomes available at the site of action</p></li>
<li><p>주성분 또는 그 활성대사체가 제제로부터 전신순환혈로 흡수되는 속도와 양의 비율</p></li>
<li><p>Pharmacokinetic (PK) measures (평가항목) of bioavailability</p>
<ul>
<li><span class="math inline">\(AUC_t\)</span>: Area under the blood or plasma concentration-time curve; 일정시간까지 혈중농도-시간곡선하면적</li>
<li><span class="math inline">\(C_{max}\)</span>: Maximum Concentration; 최고혈중농도</li>
<li><span class="math inline">\(T_{max}\)</span>: Time to Maximum Concentration; 최고혈중농도 도달시간</li>
</ul></li>
</ul>
<p><img src="../images/plasma.jpg" class="img-fluid"></p>
</section>
<section id="약품-주성분의-생체이용률의-평균적-변화" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="약품-주성분의-생체이용률의-평균적-변화"><span class="header-section-number">8.3.2</span> 약품 주성분의 생체이용률의 평균적 변화</h3>
<p><img src="../images/bioequi.jpg" class="img-fluid"></p>
</section>
<section id="생물학적동등성의-정의-fda-과-kfda" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="생물학적동등성의-정의-fda-과-kfda"><span class="header-section-number">8.3.3</span> 생물학적동등성의 정의: FDA 과 KFDA</h3>
<ul>
<li><p>Bioequivalence by FDA</p>
<p>absence of a significant difference in Bioavailability between two formulations…. when administered at the same molar dose under similar conditions in an appropriately designed study</p>
<ul>
<li><p>in vivo: Bioequivalence</p></li>
<li><p>in vitro: Bioequivalence</p></li>
</ul></li>
<li><p>KFDA</p></li>
</ul>
<p>의약품동등성시험이란 그 주성분 ·함량 및 제형이 동일한 두 제제에 대한 의약품동등성을 입증하기 위해 실시하는 생물학적동등성시험, 비교용출시험, 비교붕해등 기타시험의 생체내·외 시험을 말한다.</p>
</section>
<section id="생물학적동등성-실험의-설계" class="level3" data-number="8.3.4">
<h3 data-number="8.3.4" class="anchored" data-anchor-id="생물학적동등성-실험의-설계"><span class="header-section-number">8.3.4</span> 생물학적동등성 실험의 설계</h3>
<ul>
<li><p>생체이용률(bioavailibility)은 개인간에 변동이 크다</p></li>
<li><p>개인효과(individual effect)를 제거하기 위한 쌍비교 t-검정 (paired t-test)의 개념을 도입</p></li>
<li><p>실험자가 두 개의 처리를 모두 받는다.</p></li>
<li><p>생동성실험은 주로 <strong>교차시험(crossover design)</strong>을 이용한다.</p></li>
<li><p>제재의 반감기가 긴 경우 등 특수한 경우는 병렬계획(Parallel design) 실험도 가능하다.</p></li>
<li><p>2x2 교차실험</p></li>
</ul>
<p><img src="../images/design22.jpg" class="img-fluid"></p>
<ul>
<li>2x4 교차시험</li>
</ul>
<p><img src="../images/design24.jpg" class="img-fluid"></p>
</section>
<section id="교차실험에-대한-통계적-모형" class="level3" data-number="8.3.5">
<h3 data-number="8.3.5" class="anchored" data-anchor-id="교차실험에-대한-통계적-모형"><span class="header-section-number">8.3.5</span> 교차실험에 대한 통계적 모형</h3>
<ul>
<li><p>보통 10-20명의 실험 대상자</p></li>
<li><p>각 실험 대상자가 2개(3개 또는 4개)의 반응값(PK responses)을 가진다.</p></li>
<li><p>각 실험대상자의 반응값은 독립이 아니다 (correlated response; repeated measurements)</p></li>
<li><p>실험대상자 간의 변이가 크다 (large between-subject variation)</p></li>
<li><p>시험약과 대조약간의 (로그)반응값의 평균의 차이가 주 검토대상이다.</p></li>
<li><p>정규분포를 가정한 선형혼합모형(linear mixed model)</p></li>
</ul>
</section>
<section id="평균적-생물학적동등성에-대한-가설" class="level3" data-number="8.3.6">
<h3 data-number="8.3.6" class="anchored" data-anchor-id="평균적-생물학적동등성에-대한-가설"><span class="header-section-number">8.3.6</span> 평균적 생물학적동등성에 대한 가설</h3>
<ul>
<li>The absence of a significant difference (중대한 차이가 없다) in two population means between two formulations .</li>
</ul>
<p>= 시험약(T)과 대조약(R)간의 반응값의 평균의 차이: <span class="math inline">\(\mu_T-\mu_R\)</span>:</p>
<ul>
<li><p>보통 반응변수(PK response)에 로그를 취한 뒤 통계분석</p></li>
<li><p><span class="math inline">\(\delta=\mu_T-\mu_R\)</span>: 시험약(T)과 대조약(R)간의 로그 반응값의 평균의 차이</p></li>
<li><p>평균적 생물학적동등성에 대한 가설</p></li>
</ul>
<p><span class="math display">\[ H_0: \delta \le \delta_L ~~~or~~~ \delta \ge \delta_U   \quad vs. \quad H_1: \delta_L &lt; \delta &lt; \delta_U \]</span></p>
<ul>
<li>동등성 한계 (bioequivalence limit)</li>
</ul>
<p><span class="math display">\[ \delta_L=-0.223=log(0.8) \quad and \quad \delta_U=0.223=log(1.25) \]</span></p>
<ul>
<li>평균적 생물학적동등성에 대한 가설(로그변환 전)</li>
</ul>
<p><span class="math display">\[ H_1: 0.8 &lt; \frac{\mu'_T}{\mu'_R} &lt; 1.25 \]</span></p>
<ul>
<li>평균적 생물학적동등성을 어떤 통계적 방법으로 검정할 것인가?</li>
</ul>
<p><span class="math display">\[ H_0: \delta \le \delta_L ~~~or~~~ \delta \ge \delta_U   \quad vs. \quad H_1: \delta_L &lt; \delta &lt; \delta_U \]</span></p>
<ul>
<li><p>Historical development of statistical tests for ABE</p>
<ul>
<li><p>Westlake (1976), Hsu (1984), Bofinger (1985, 1992), Schuirmann (1987), Liu(1990)</p></li>
<li><p>Berger and Hsu (1996), Brown, Hwang, and Munk (1997), Perlman and Wu (1999), Welleck (2003), Romano (2005)</p></li>
<li><p>FDA guidance: 1992, 1997, 1999, 2000 and some drafts</p></li>
</ul></li>
<li><p>가설</p></li>
</ul>
<p><span class="math display">\[ H_0: |\mu_T-\mu_R| \ge \delta  \quad vs. \quad H_1: |\mu_T-\mu_R| &lt; \delta \]</span></p>
<ul>
<li><p>신뢰구간을 이용한 방법</p></li>
<li><p>2개의 단측검정을 결합한 방법 (Two ones-sided tests; TOST)</p></li>
</ul>
<p><span class="math display">\[ H_{01}: \mu_T-\mu_R  &lt; -\delta \text{ and } H_{02}:  \mu_T-\mu_R  &gt; \delta \]</span></p>
</section>
<section id="신뢰구간을-이용한-평균적-생물학적동등성-검정" class="level3" data-number="8.3.7">
<h3 data-number="8.3.7" class="anchored" data-anchor-id="신뢰구간을-이용한-평균적-생물학적동등성-검정"><span class="header-section-number">8.3.7</span> 신뢰구간을 이용한 평균적 생물학적동등성 검정</h3>
<ul>
<li>가설</li>
</ul>
<p><span class="math display">\[ H_0: |\mu_T-\mu_R| \ge \delta  \quad vs. \quad H_1: |\mu_T-\mu_R| &lt; \delta \]</span></p>
<ul>
<li><p><span class="math inline">\(\mu_T-\mu_R\)</span> 에 대한 신뢰구간 <span class="math inline">\(C(Y)\)</span> 를 구한다.</p></li>
<li><p>신뢰구간이 동등성 한계안에 포함되면 평균적 생물학적동등성 선언!</p></li>
</ul>
<p><span class="math display">\[ C(y) \subset (-\delta,\delta) \]</span></p>
</section>
<section id="개의-단측검정을-이용한-방법" class="level3" data-number="8.3.8">
<h3 data-number="8.3.8" class="anchored" data-anchor-id="개의-단측검정을-이용한-방법"><span class="header-section-number">8.3.8</span> 2개의 단측검정을 이용한 방법</h3>
<ul>
<li><p>정규분포 가정</p></li>
<li><p>각 처리에 대한 평균 <span class="math inline">\(\bar {y}_T\)</span> 과 <span class="math inline">\(\bar {y}_R\)</span> 는 <span class="math inline">\(\mu_T\)</span> 과 <span class="math inline">\(\mu_R\)</span>의 추정량</p></li>
<li><p><span class="math inline">\(SE\)</span> 를 <span class="math inline">\(\bar {y}_T-\bar {y}_R\)</span>의 표준 오차(standard error)라고 하자</p></li>
<li><p>다음을 만족하면 귀무가설 <span class="math inline">\(H_0\)</span>를 기각 (생물학적 동등성을 선언)</p></li>
</ul>
<p><span class="math display">\[
\frac{ \bar {y}_T-  \bar {y}_R +\delta}{SE} &gt; t_\alpha ~~\text{ and }~~
\frac{ \bar {y}_T-  \bar {y}_R -\delta}{SE} &lt;- t_\alpha
\]</span></p>
<ul>
<li>위의 귀무가설 기각조건은 아래와 동일한다 (90% 신뢰구간이 동등성 한계안에 있다)</li>
</ul>
<p><span class="math display">\[
[(\bar {y}_T-  \bar {y}_R - t_\alpha (SE),~ (\bar {y}_T-  \bar {y}_R + t_\alpha(SE) )] \subseteq
(-\delta,~\delta)
\]</span></p>
<ul>
<li><p>TOST is a special case of intersection-union test (Berger and Hsu, 1996)</p></li>
<li><p>TOST is level <span class="math inline">\(2\alpha\)</span> test, but its size is actually <span class="math inline">\(\alpha\)</span>.</p></li>
</ul>
<p><span class="math display">\[ \text{size of test } = \sup_{H_0} P( \text{ test rejects } H_0 ) \]</span></p>
<ul>
<li><p>Improved tests are proposed by Berger and Hsu (1996), Brown, Hwang, and Munk (1997), Perlman and Wu (1999), Welleck (2003), Romano (2005)</p></li>
<li><p>But, still TOST is widely used because of its validity and simplicity</p></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-chen2017clinical" class="csl-entry" role="listitem">
Chen, Ding-Geng Din, Karl E Peace, 와/과 Pinggao Zhang. 2017. <em>Clinical trial data analysis using R and SAS</em>. CRC Press.
</div>
<div id="ref-kang2008" class="csl-entry" role="listitem">
Kang, Seung-Ho. 2008. <span>“동등성 시험을 신뢰구간을 사용하여 검정하는 경우 왜 신뢰도 90”</span>. <em>응용통계연구</em> 21 (5): 867--73.
</div>
<div id="ref-walker2011understanding" class="csl-entry" role="listitem">
Walker, Esteban, 와/과 Amy S Nowacki. 2011. <span>“Understanding Equivalence and Noninferiority Testing”</span>. <em>Journal of general internal medicine</em> 26 (2): 192–96.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "복사완료!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "복사완료!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../qmd/response.html" class="pagination-link" aria-label="반응표면 분석">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">반응표면 분석</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>