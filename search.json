[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "실험계획법 2024 강의 노트",
    "section": "",
    "text": "서론\n이 온라인 교과서는 2024년 실험계회법 강의의 보조 교재입니다.\n강의교재는 임용빈 (2020) 를 참고하시기 바랍니다.",
    "crumbs": [
      "서론"
    ]
  },
  {
    "objectID": "index.html#필요한-r-라이브러리",
    "href": "index.html#필요한-r-라이브러리",
    "title": "실험계획법 2024 강의 노트",
    "section": "필요한 R 라이브러리",
    "text": "필요한 R 라이브러리\nlibrary(here)           # file pathways\nlibrary(tidyverse)      # data management, summary, and visualization\nlibrary(MASS)\nlibrary(knitr)\nlibrary(kableExtra)\n\nlibrary(agricolae)\nlibrary(emmeans)\n\nlibrary(showtext)\nfont_add_google(\"Nanum Pen Script\", \"gl\")\nshowtext_auto()\n\n# 참고도서 데이터 \nlibrary(MontgomeryDAE)\n\n\n\n\n\n임용빈. 2020. Design Expert, Minitab 과 R을 활용한 실험계획법. 자유아카데미.",
    "crumbs": [
      "서론"
    ]
  },
  {
    "objectID": "qmd/oneway.html",
    "href": "qmd/oneway.html",
    "title": "1  일원배치법",
    "section": "",
    "text": "1.1 두 집단의 평균 비교",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>일원배치법</span>"
    ]
  },
  {
    "objectID": "qmd/oneway.html#두-집단의-평균-비교",
    "href": "qmd/oneway.html#두-집단의-평균-비교",
    "title": "1  일원배치법",
    "section": "",
    "text": "1.1.1 t-검정\n기초통계학에서 나오는 가장 기본적이고 자주 쓰이는 가설검정 방법은 두 집단의 평균의 차이를 검정하는 t-검정(t-test)이다.\n교과서 2장 예제 2.2 를 다시 보자. 공장의 두 개 라인에서 생산되는 시멘트의 인장강도에 유의한 차이가 있는지 통계적 가설 검정을 수행하려고 한다. 첫 번째 생산라인을 \\(1\\), 두 번째 생산라인을 \\(2\\) 라고 했을 때 각각의 라인에서 시멘트 인장강도의 평균을 \\(\\mu_1\\), \\(\\mu_2\\)이라고 하자.\n여기서 고려해야할 가설은 다음과 같다.\n\\[ H_0: \\mu_1 = \\mu_2 \\quad \\text{vs.} \\quad H_1: \\mu_1  \\ne \\mu_2 \\]\n두 집단이 분산이 동일한 정규분포 \\(N(\\mu_1, \\sigma^2)\\), \\(N(\\mu_2, \\sigma^2)\\)를 따른다고 가정하고 다음과 같이 각각 \\(n_1\\), \\(n_2\\)개의 독립 표본을 얻었다고 하자.\n\\[ y_{11}, y_{12}, \\dots, y_{1 n_1} \\sim N(\\mu_1, \\sigma^2), \\quad y_{21}, y_{22}, \\dots, y_{2 n_2} \\sim N(\\mu_2, \\sigma^2) \\]\n위의 가설을 다음과 같은 t-통계량을 이용하여 검정할 수 있다.\n\\[ t_0 =\\frac {\\bar y_1 -\\bar y_2 } {  s_p \\sqrt{1/n_1 + 1/n_2}} \\]\n여기서 \\(\\bar y_1\\), \\(\\bar y_2\\)은 두 생산라인에서 추출된 표본의 평균을 나타내고 \\(n_1\\), \\(n_2\\) 은 각 집단의 표본 개수를 나타낸다. 또한 \\(s_p^2\\) 은 두 집단의 공통분산 추정량이며 다음과 같이 계산한다.\n\\[ \\hat \\sigma^2 = s_p^2 =  \\frac { \\sum_{i=1}^{n_1} (y_{1i} -\\bar y_1)^2 + \\sum_{i=1}^{n_2} (y_{2i} -\\bar y_2)^2 } { n_1 + n_2 -2} \\]\n위에서 구한 t-통계량의 절대값이 크다면 귀무가설 \\(H_0\\) 에 반대되는 증거이다. 유의수준을 \\(\\alpha\\)라고 했을 때 t-통계량 \\(t_0\\)의 절대값이 자유도 \\(df=n_1 + n_2 -2\\) 를 가지는 t-분포의 상위 \\(\\alpha/2\\) 분위수보다 크면 귀무가설을 기각하고 대립가설 \\(H_1\\)을 채택한다.\n\\[ \\text{ Reject } H_0  \\quad \\text { if } ~~ |t_0| &gt; t(1-\\alpha/2, n_1 + n_2 -2 ) \\]\n가설 검정은 p-값(p-value)을 구하고 그 값이 \\(\\alpha\\)보다 작으면 귀무가설을 기각하는 방법을 사용할 수 있다.\n\\[ \\text{ Reject } H_0  \\quad \\text { if    p-value } &lt; \\alpha \\]\n여기서 \\(p-value\\) 는 다음과 같이 계산할 수 있으며 \\(t(n_1 + n_1 -2 )\\)는 자유도가 \\(n_1 + n_2 -2\\)을 가지는 \\(t\\)-분포를 따르는 확률변수이다. .\n\\[ \\text {p-value }=2 P[ t(n_1 + n_2 -2 ) &gt;|t_0|] \\]\nR 에서 함수 t.test를 이용하여 두 집단에 대한 t-검정을 실시해 보자.\n\nline1 &lt;- c(16.9, 16.4, 17.2, 16.4, 16.5, 17.0, 17.0, 17.2, 16.6, 16.6)\nline2 &lt;- c(16.6, 16.8, 17.4, 17.1, 17.0, 16.9, 17.3, 17.0, 17.1, 17.3)\ndf220 &lt;- data.frame(line1, line2)\n\ndf220\n\n   line1 line2\n1   16.9  16.6\n2   16.4  16.8\n3   17.2  17.4\n4   16.4  17.1\n5   16.5  17.0\n6   17.0  16.9\n7   17.0  17.3\n8   17.2  17.0\n9   16.6  17.1\n10  16.6  17.3\n\ndf22&lt;- df220 %&gt;% pivot_longer(cols = everything(), names_to = \"line\", values_to = \"strength\") %&gt;% dplyr::arrange(line)\n\ndf22\n\n# A tibble: 20 × 2\n   line  strength\n   &lt;chr&gt;    &lt;dbl&gt;\n 1 line1     16.9\n 2 line1     16.4\n 3 line1     17.2\n 4 line1     16.4\n 5 line1     16.5\n 6 line1     17  \n 7 line1     17  \n 8 line1     17.2\n 9 line1     16.6\n10 line1     16.6\n11 line2     16.6\n12 line2     16.8\n13 line2     17.4\n14 line2     17.1\n15 line2     17  \n16 line2     16.9\n17 line2     17.3\n18 line2     17  \n19 line2     17.1\n20 line2     17.3\n\nt.test(strength~line, df22, paired = FALSE, var.equal = TRUE, conf.level = 0.95)\n\n\n    Two Sample t-test\n\ndata:  strength by line\nt = -2.1338, df = 18, p-value = 0.04687\nalternative hypothesis: true difference in means between group line1 and group line2 is not equal to 0\n95 percent confidence interval:\n -0.535840211 -0.004159789\nsample estimates:\nmean in group line1 mean in group line2 \n              16.78               17.05 \n\n\n유의수준을 0.05로 정하면 t-검정의 결과 p-값이 유의수준 보다 작아서 귀무가설을 기각하고 대립가설 \\(H_1\\)을 채택한다. 즉, 두 라인의 시멘트 인장강도 평균은 유의하게 다르다.\n\n\n1.1.2 t-검정의 재구성\n이제 두 집단에 대한 가설 검정을 세 개 이상인 여러 개의 집단으로 확장하는 경우를 생각해보자. 여러 개의 집단에 대한 가설 검정을 고려하기 전에 두 집단에 대한 t-검정을 약간 재구성하여 여러 평균들의 차이를 비교하는 검정법에 대한 일반적인 개념을 제시해 보려고 한다. 이제 t-검정에서 검정 통계량의 분자와 분모를 따로 살펴보자\n\\[ t_0 =\\frac {\\bar y_1 -\\bar y_2 } { s_p \\sqrt{1/n_1 + 1/n_2}} \\]\nt-검정 통계량의 분자는 집단 간의 평균의 차이를 나타낸다. 즉 \\(\\bar y_1 -\\bar y_2\\)는 두 집단의 표본 평균의 차이를 추정하는 양이고 그 차이가 크면 클수록 두 집단의 모평균의 차이 \\(\\mu_1 - \\mu_2\\)가 크다는 것을 의미한다.\nt-검정 통계량의 분모는 두 집단의 공통분산 추정량 \\(\\hat \\sigma^2 =s_p^2\\)에 비례한다. 즉 집단 내의 변동을 반영하는 \\(s_p^2\\) 이 크면 클수록 t-검정 통계량은 그 크기가 작아져서 귀무가설의 기각을 어렵게 한다.\n\\[ s^2_p = \\frac{\\sum_{i=1}^{n_1} (y_{1i} -\\bar y_1)^2 + \\sum_{i=1}^{n_2} (y_{2i} -\\bar y_2)^2}{n_1+n_2-2} \\]\n또한 t-검정 통계량는 표본의 수(\\(n_1\\)과 \\(n_2\\))에 비례한다. 즉 표본의 수가 증가햐면 t-검정 통계량이 커지게 된다.\n정리해보면 t-검정 통계량은 집단 간의 변동(between-group variation)을 집단 내의 변동(within-group variation) 으로 나누어준 값이다. 다른 말로 급간 변동과 급내 변동을 사용하기도 한다.\n이제 t-검정 통계량을 제곱하면 다음과 같이 표현할 수 있다.\n\\[  t_0^2 =\\frac { (\\bar y_1 -\\bar y_2)^2 } { s_p^2 (1/n_1 + 1/n_2)} = \\frac{\\text{between-group variation}} {\\text{within-group variation}} \\]\n두 집단의 평균을 비교하는 t-검정 통계량은 집단 간의 변동(집단 간의 평균들의 차이)과 집단 내의 변동(집단 내 관측치들의 퍼진 정도)의 비율로 구성된 통계량으로 생각할 수 있으며 이러한 개념을 3개 이상의 집단을 비교하는 경우로 쉽게 확장할 수 있다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>일원배치법</span>"
    ]
  },
  {
    "objectID": "qmd/oneway.html#일원배치법",
    "href": "qmd/oneway.html#일원배치법",
    "title": "1  일원배치법",
    "section": "1.2 일원배치법",
    "text": "1.2 일원배치법\n\n1.2.1 일원배치을 이용한 랜덤화 실험계획법\n\n일원배치법(one-way randomization design)은 관심있는 중요한 한 개 요인이 반응변수에 어떠한 영향을 미치는지 알아보는 실험법이다.\n반응값에 영향을 주는 다른 요인들에 대한 정보가 많고 사전 실험이 많이 이루어져서 가장 중요한 요인의 미세한 영향을 조사하고자 할 때 유용하다.\n처리를 제외한 다른 요인들의 영향을 적절하게 통제할 수 있어야 한다.\n\n\n\n1.2.2 실험배정의 랜덤화\n실험배정의 랜덤화 방법은 교과서 38-41 페이지 참조\n\n\n\n1.2.3 예제 3.1 - 자료\n이 실험에서 요인은 직물이며 4개 수준은 4개의 납품업체에서 공급한 서로 다른 직물이다. 실험 목적은 4개의 직물의 긁힘에 대한 저항력을 비교하는 실험이다. 각 업체마다 4개의 제품을 랜덤하게 선택하여 일원배치법으로 마모도 검사를 실시하였다.\n\ncompany&lt;- as.factor(rep(c(1:4), each=4))\nresponse&lt;- c(1.93, 2.38, 2.20, 2.25,\n             2.55, 2.72, 2.75, 2.70,\n             2.40, 2.68, 2.32, 2.28,\n             2.33, 2.38, 2.28, 2.25)\ndf31 &lt;- data.frame(company=company, response= response)\n\ndf31\n\n   company response\n1        1     1.93\n2        1     2.38\n3        1     2.20\n4        1     2.25\n5        2     2.55\n6        2     2.72\n7        2     2.75\n8        2     2.70\n9        3     2.40\n10       3     2.68\n11       3     2.32\n12       3     2.28\n13       4     2.33\n14       4     2.38\n15       4     2.28\n16       4     2.25\n\nggplot(df31, aes(company, response)) +   geom_point(aes(colour = factor(company)), size = 2)\n\n\n\n\n\n\n\n\n실험에서는 처리 이외의 다른 요인들이 적절하게 통제되는 것이 매우 중요하다. 4개의 처리 외에 마모도 검사의 결과에 영향을 미칠 수 있는 다른 요인을 생각해 보자.\n\n검사를 수행하는 사람\n마모도를 검사하는 도구 또는 기계\n검사를 실시하는 환경 (측정 시간, 장소 등)\n마모도 검사의 배정을 완전 임의(completely randomized)로 할 수 있는지?\n\n일원배치법으로 실험을 진행할 떄 다음과 같은 상항들을 고려해야 한다.\n\n처리 이외의 다른 요인들을 적절하게 통제할 수 있는가?\n어떤 경우에 완전한 랜덤화가 불가능한가? 이러한 경우 실험의 배정을 어떻게 해야 할까?\n\n\n\n1.2.4 일원배치법의 자료 구조와 모형\n\n일원배치법에서의 자료 구조는 교과서 41-44 페이지 참조\n\n일원배치법 실험에서는 하나의 요인 A 의 효과를 측정한다. 요인 A 에 대하여 서로 다른 a 개의 수준(\\(A_1, A_2, \\dots, A_a\\))의 효과를 비교한다고 가정하자. 각 수준에 대하여 \\(r_i\\) 개의 반응값을 반복 측정한다.\n이제 \\(i\\)번 수준에서 측정된 \\(j\\)번째 반응변수의 값을 \\(x_{ij}\\)라고 하자. 일원배치법에서 측정된 자료들은 다음과 같은 모형을 가진다고 가정한다.\n\\[\nx_{ij} = \\mu_i + e_{ij} \\text{ where } e_{ij} \\sim N(0,\\sigma_E^2)\n\\tag{1.1}\\]\n여기서 오차항 \\(e_{ij}\\)는 모두 독립이다.\n첨자 \\(i\\)는 실험의 수준에 나타낸다 (\\(i=1, 2, \\cdots, a\\)). 균형자료의 경우는 모든 수준에 대하여 반복수가 같은 경우이다 (\\(j=1,2,\\cdots,r\\)). 불균형자료의 경우는 수준에 대하여 반복수가 다른 경우이다 (\\(j=1,2,\\cdots,r_i\\)). \n식 1.1 은 일반적으로 평균모형(mean model) 이라고 부르며 모형의 이름대로 모두 \\(\\mu_i\\)는 \\(i\\)번째 수준의 평균을 의미한다.\n\\[ E(x_{ij}) = E(\\mu_i + e_{ij}) = \\mu_i \\]\n이제 식 1.1 을 약각 변형하여 다른 형식의 모형을 만들어 보자.\n\\[\\begin{align*}\nx_{ij} & = \\mu_i + e_{ij} \\\\\n      & = \\mu + (\\mu_i - \\mu) + e_{ij} \\\\\n      & = \\mu + \\alpha_i + e_{ij}\n\\end{align*}\\]\n위의 모형에서 모수 \\(\\mu\\)는 반응값의 전체 평균을 의미하며 \\(\\alpha_i = \\mu_i - \\mu\\)는 \\(i\\)번째 수준의 평균이 전체 평균과 어떻게 다른지 나타내는 수준의 상대적 효과를 의미한다.\n다음의 식으로 정의된 일원배치 모형을 주효과모형(main effect model) 이라고 부른다. 모수 \\(\\alpha_i\\)는 \\(i\\) 번째 집단의 효과(처리 효과; treatment effect)를 나타낸다고 할 수 있다.\n\\[\nx_{ij} = \\mu + \\alpha_i + e_{ij} \\text{ where } e_{ij} \\sim N(0,\\sigma_E^2)\n\\tag{1.2}\\]\n여기서 오차항 \\(e_{ij}\\)는 모두 독립이며 다음과 같은 제약조건이 있다.\n\\[\n\\sum_{i=1}^a \\alpha_i = 0\n\\tag{1.3}\\]\n식 1.3 의 제약조건은 모수의 개수(\\(a+1\\))가 그룹의 개수(\\(a\\))보다 많아서 발생하는 문제를 해결하기 위하여 모수에 대한 제약 조건 1개를 고려해서 모수의 개수와 그룹의 개수를 맞추어준 것이다. 나중에 이러한 제약조건에 대한 이론을 자세히 다루기로 한다.\n식 1.3 의 제약조건은 sum to zero조건이라고 부르며 문제를 해결하는 유일한 조건은 아니다. 예를 들어서 조건 식 1.3 의 제약조건을 대신하여 \\(\\alpha_1=0\\) 인 set to zero 조건을 사용할 수 있다.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>일원배치법</span>"
    ]
  },
  {
    "objectID": "qmd/oneway.html#분산분석",
    "href": "qmd/oneway.html#분산분석",
    "title": "1  일원배치법",
    "section": "1.3 분산분석",
    "text": "1.3 분산분석\n\n1.3.1 모형과 가설\n집단의 모평균을 편의상 \\(\\mu_1, \\mu_2, \\cdots, \\mu_a\\) 이라고 하자. 평균모형 식 1.1 을 가정하고 집단들 사이에 차이가 있는지에 대한 가설은 다음과 같다.\n\\[ H_0: \\mu_1 = \\mu_2 =\\dots =\\mu_a \\quad \\text{vs.} \\quad H_1: \\text{ not } H_0 \\]\n위의 가설에서 주의할 점은 대립가설 \\(H_1\\)의 경우애 평균들이 서로 다른 경우가 매우 다양하다는 것이다. 예를 들어 집단이 3개 인 경우 \\(\\mu_1 = \\mu_2  &lt; \\mu_3\\)일 수 도 있고 \\(\\mu_1 &lt; \\mu_2  &lt; \\mu_3\\) 있으며 이 외에 매우 다양한 경우들이 있다.\n이제 효과모형 식 1.2 을 고려하면 집단들 사이에 차이가 있는지에 대한 가설을 다음과 같이 바꿀수 있다. 집단에 대한 효과가 모두 0이 되면 집단 간의 평균에 대한 차이는 없다.\n\\[\nH_0: \\alpha_1 = \\alpha_2 =\\cdots=\\alpha_a =0  \\quad \\text{vs.} \\quad H_1: \\text{ not } H_0\n\\tag{1.4}\\]\n\n\n1.3.2 변동의 분해\n이제 앞 절에서 생각해본 t-검정의 재구성처럼 집단 간의 변동(각 집단의 평균의 차이가 얼마나 나는지에 대한 통계량)과 집단 내의 변동(각 집단내에서 관측값들의 퍼진 정도)를 측정하는 통계량을 찾아서 검정 통계량을 구성해 보자.\n일단 다음과 같이 전체 평균과 집단의 평균을 정의하자.\n\\[ \\bar{\\bar {x}} =  \\frac{\\sum_{i=1}^a \\sum_{j=1}^r x_{ij}}{ar} =\\frac{T}{ar}, \\quad  \\bar {x}_{i.} =   \\frac{\\sum_{j=1}^r x_{ij}}{r} = \\frac{T_{i.}}{r} \\]\n이제 하나의 관측값 \\(x_{ij}\\)과 전체 평균 \\(\\bar{\\bar {x}}\\) 간의 편차(deviation)를 다음과 같이 분해해 보자.\n\\[\n\\underbrace{ x_{ij} - \\bar{\\bar {x}} }_{\\text{total deviation}}  = \\underbrace{ ( x_{ij} - \\bar {x}_{i.} )}_{\\text{within-group deviation}} + \\underbrace{(\\bar {x}_{i.} - \\bar{\\bar {x}} )}_{\\text{between-group deviation}}\n\\tag{1.5}\\]\n식 1.5 에서 집단 평균과 총 평균의 편차 (\\(\\bar {x}_{i.} - \\bar{\\bar {x}}\\))는 처리의 효과를 측정할 수 있는 통계량이다. 집단 간의 차이를 반영하는 양으로 처리 효과 \\(\\alpha_i\\)들에 의하여 발생한다.\n집단 내의 관측값과 집단 평균의 차이 (\\(x_{ij} - \\bar {x}_{i.}\\))는 집단 내의 변동을 나타내는 통계량으로 측정 오차 \\(e_{ij}\\)에 의하여 발생한다.\n식 1.5 의 각 편차들은 양수와 음수로서 부호를 가지기 때문에 이를 변동으로 표현하기 위하여 차이를 제곱하여 합친 제곱합(sum of squares)을 고려해 보자.\n\\[\\begin{align*}\n\\sum_{i=1}^a \\sum_{j=1}^r (x_{ij} - \\bar{\\bar {x}})^2\n    & = \\sum_{i=1}^a \\sum_{j=1}^r \\left [ ( x_{ij} - \\bar {x}_{i.} ) + (\\bar {x}_{i.} - \\bar{\\bar {x}} ) \\right ]^2 \\\\\n    & = \\sum_{i=1}^a \\sum_{j=1}^r ( x_{ij} - \\bar {x}_{i.} )^2 + \\sum_{i=1}^a \\sum_{j=1}^r (\\bar {x}_{i.} - \\bar{\\bar {x}} )^2 + 2   \\sum_{i=1}^a \\sum_{j=1}^r ( x_{ij} - \\bar {x}_{i.} ) (\\bar {x}_{i.} - \\bar{\\bar {x}} ) \\\\\n    & = \\sum_{i=1}^a \\sum_{j=1}^r ( x_{ij} - \\bar {x}_{i.} )^2 + \\sum_{i=1}^a r (\\bar {x}_{i.} - \\bar{\\bar {x}} )^2 + 0 (why?) \\\\\n\\end{align*}\\]\n결과적으로 다음과 같은 변동의 분해를 제곱합의 형식으로 얻을 수 있다.\n\\[\n\\underbrace{ \\sum_{i=1}^a \\sum_{j=1}^r (x_{ij} - \\bar{\\bar {x}})^2  }_{\\text{total variation}}  = \\underbrace{ \\sum_{i=1}^a \\sum_{j=1}^r ( x_{ij} - \\bar {x}_{i.} )^2 }_{\\text{within-group variation}} + \\underbrace{\\sum_{i=1}^a \\sum_{j=1}^r (\\bar {x}_{i.} - \\bar{\\bar {x}} )^2 }_{\\text{between-group variation}}\n\\tag{1.6}\\]\n분해 식 1.6 에서 나타난 각 제곱합에 대한 이름과 의미를 살펴보자.\n\n\\(SS_T\\)를 총 제곱합(Total Sum of Squares)이라고 부르며 자료의 전체 변동을 의미한다.\n\n\\[ SS_T = \\sum_{i=1}^a \\sum_{j=1}^r (x_{ij} - \\bar{\\bar {x}})^2 \\]\n\n\\(SS_E\\)를 잔차 제곱합(Residual Sum of Squares)이라고 부르며 관측 오차에 발생된 집단 내의 변동 또는 급내 변동(within-group variation)을 의미한다.\n\n\\[ SS_E = \\sum_{i=1}^a \\sum_{j=1}^r  ( x_{ij} - \\bar {x}_{i.} )^2 \\]\n\n\\(SS_A\\)를 처리 제곱합(Treatment Sum of Squares)이라고 부르며 처리들의 차이로 발생하는 변동으로거 집단 간의 변동 또는 급간 변동(bwtween-group variation)을 의미한다.\n\n\\[ SS_A = \\sum_{i=1}^a \\sum_{j=1}^r (\\bar {x}_{i.} - \\bar{\\bar {x}} )^2 =\\sum_{i=1}^a r (\\bar {x}_{i.} - \\bar{\\bar {x}} )^2 \\]\n이제 분해 식 1.6 을 다음과 같이 나타낼수 있다.\n\\[\nSS_T = SS_A + SS_E\n\\tag{1.7}\\]\n위의 분해식에서 볼 수 있듯이 집단 간의 변동의 크기를 나타내는 처리제곱합이 커질수록, 또는 집단내의 변동의 크기를 나타내는 오차제곱합이 작아질수록 귀무가설에 반대되는(즉, 집단 간의 평균이 유의한 차이가 난다는) 증거가 강해진다.\n\n\n1.3.3 자유도\n제곱합은 편차(deviation)의 제곱들을 더한 형태로서 각 제곱합들에 대하여 해당하는 자유도(degrees of freedom; df 또는 \\(\\phi\\)로 표기)를 구할 수 있다.\n제곱합의 자유도 = 제곱합을 구성하는 편차의 개수 – 선형제약 조건의 개수 \n각 제곱합에 대한 선형제약조건은 편차들의 합이 0이 되는 조건이다. 이제 식 식 1.7 에 주어진 제곱합의 자유도에 대한 정보를 다음과 같이 정리할 수 있다.\n\n\n\n\n\n\n\n\n\n\n제곱합\n편차의 개수\n제약조건\n제약조건의 수\n자유도\n\n\n\n\n\\(SS_T\\)\n\\(ar\\)\n\\(\\sum_{i=1}^a \\sum_{j=1}^r (x_{ij} - \\bar{\\bar {x}})=0\\)\n1\n\\(\\phi_T= ar-1\\)\n\n\n\\(SS_A\\)\n\\(a\\)\n\\(\\sum_{i=1}^a (\\bar {x}_{i.} - \\bar{\\bar {x}} ) =0\\)\n1\n\\(\\phi_A=a-1\\)\n\n\n\\(SS_E\\)\n\\(ar\\)\n\\(\\sum_{j=1}^r ( x_{ij} - \\bar {x}_{i.} ) =0, i=1,2,..,a\\)\na\n\\(\\phi_E=ar-a\\)\n\n\n\n\n\n1.3.4 평균제곱합과 F-통계량\n이제 가설 식 1.4 을 검정하기 위한 통계량을 구성해 보자. 먼저 다음과 같은 제곱합들을 각 자유도로 나눈 평균제곱합(Mean Sum of Squares)를 정의한다.\n\\[\nMS_A = \\frac{SS_A}{\\phi_A}, \\quad MS_E =\\frac{SS_E}{\\phi_E}\n\\tag{1.8}\\]\n앞 절에서 t-검정을 재구성하면서 알아본 통계량의 의미를 다시 생각해 보자. 집단 간의 변동과 집단 내의 변동의 상대적 비율로 그룹 간의 차이를 검정할 수 있다는 개념을 확장하여 다음과 같은 F-통계량 \\(F_0\\) 를 만들어 보자.\n\\[\nF_0 =  \\frac{MS_A}{MS_E} = \\frac{\\text{between-group variation}} {\\text{within-group variation}}\n\\tag{1.9}\\]\n위 식 1.9 에서 정의된 F-통계량은 그룹 간에 평균의 차이가 클수록, 그룹 내의 차이가 작을 수록 그 값이 커진다. 따라서 F-통계량의 값이 크면 클수록 귀무가설에 반대되는 증거가 강해진다.\n이렇게 전체의 변동을 집단 간의 변동과 집단 내의 변동으로 나누어 집단 간의 평균의 차이를 추론하는 방법을 분산분석(Analysis of Variance, ANOVA)이라고 한다.\n\n\n1.3.5 분산분석을 이용한 F-검정\n이제 식 1.9 에서 정의된 F-통계량을 이용하여 가설 식 1.4 를 검정하는 통계적 방법을 만들어 보자. 일단 두 제곱합의 통계적 성질은 다음과 같다.\n\n잔차 제곱합을 오차항의 분산으로 나눈 통계량은 자유도가 \\(\\phi_E\\) 를 가지는 카이제곱 분포를 따른다.\n\n\\[ \\frac{SS_E}{\\sigma_E^2}  \\sim \\chi^2(\\phi_E) \\]\n\n귀무가설이 참인 경우 처리 제곱합을 오차항의 분산으로 나눈 통계량은 자유도가 \\(\\phi_A\\) 를 가지는 카이제곱 분포를 따른다.\n\n\\[ \\frac{SS_A}{\\sigma_E^2}  \\sim \\chi^2(\\phi_A) \\quad \\text{ under } H_0  \\]\n\n잔차 제곱합과 처리 제곱합은 서로 독립이다.\n\n따라서 귀무가설이 참인 경우 F-통계량은 자유도가 \\(\\phi_A, \\phi_E\\)를 가지는 F-분포를 따른다.\n\\[\nF_0 =  \\frac{MS_A}{MS_E} = \\frac{ \\tfrac{SS_A/\\sigma_E^2}{\\phi_A}} {\\tfrac{SS_E/\\sigma_E^2}{\\phi_E }}  \\sim F(\\phi_A, \\phi_E) \\quad \\text{ under } H_0  \n\\tag{1.10}\\]\n유의수준 \\(\\alpha\\)에서 F-통계량이 기각역을 벗어나면 귀무가설을 기각한다.\n\\[ \\text{ Reject } H_0 \\text{ if } F_0 &gt; F(1-\\alpha, \\phi_A, \\phi_E)  \\]\n또는 다음과 같이 게산된 p-값이 유의수준 \\(\\alpha\\) 보다 작으면 귀무가설을 기각한다.\n\\[ p-value = P[F(\\phi_A, \\phi_E) &gt; F_0  ]   \\]\nF-통계량을 정의할 때 편리하고 유용하게 사용되는 것이 다음과 같은 분산분석표(ANOVA table)이다.\n\n\n\n\n\n\n\n\n\n\n\n요인\n제곱합\n자유도\n평균제곱합\n\\(F_0\\)\np-값\n\n\n\n\n처리\n\\(SS_A\\)\n\\(\\phi_A = a-1\\)\n\\(MS_A=SS_A/\\phi_A\\)\n\\(F_0=MS_A/MS_E\\)\n\\(P[F(\\phi_A, \\phi_E) &gt; F_0  ]\\)\n\n\n잔차\n\\(SS_E\\)\n\\(\\phi_E=a(r-1)\\)\n\\(MS_E=SS_E/\\phi_E\\)\n\n\n\n\n총합\n\\(SS_T\\)\n\\(\\phi_T =  ar-1\\)\n\n\n\n\n\n\n\n\n1.3.6 분산분석 후의 추정\n분산분석에서 고려한 요인 A의 수준에 따라서 반응값의 평균에 유의한 차이가 있다고 결론이 나면 그룹 간의 모평균을 차이에 대한 더 자세한 정보가 필요하다. 즉 집단들의 평균이 서로 유의하게 다르거나 같은지에 대한 정보를 얻는 것이 중요하다.\n일단 모집단의 분산 \\(\\sigma_E^2\\) 에 대한 추정은 잔차제곱합의 분포를 이용하면 다음과 같은 불편추정량을 얻을 수 있다.\n\\[ \\hat \\sigma_E^2 = MS_E, \\quad E(MS_E) = \\sigma_E^2 \\]\n다음으로 각 수준(집단)에 대한 평균에 대한 추정량은 표본평균 \\(\\bar {x}_{i.}\\) 이며\n\\[ \\hat \\mu_i = \\widehat {\\mu + \\alpha_i} = \\bar {x}_{i.}  \\quad E(\\bar {x}_{i.}) =\\mu_i \\]\n\\(100(1-\\alpha)\\) % 신뢰구간(confidence interval)은 다음과 같이 주어진다.\n\\[ \\bar {x}_{i.} \\pm t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{MS_E}{r}} \\]\n야기서 \\(t(1-\\alpha/2, \\phi_E)\\)는 자유도 \\(\\phi_E\\)를 가지는 t-분포의 \\(1-\\alpha/2\\) 분위수를 의미한다.\n이제 두 개의 수준에 대한 평균의 차이에 대한 통계적 추론을 생각해 보자. 수준 \\(A_i\\)와 \\(A_j\\)의 평균의 차이에 대한 추정과 검정을 하려고 한다.\n\\[ \\delta_{ij} = \\mu_i-\\mu_j = \\alpha_i - \\alpha_j \\]\n두 평균의 차이 \\(\\delta_{ij}\\) 에 대한 \\(100(1-\\alpha)\\) % 신뢰구간은 다음과 같이 주어진다.\n\\[\n( \\bar {x}_{i.} - \\bar {x}_{j.})   \\pm t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{2MS_E}{r}}\n\\tag{1.11}\\]\n신뢰구간 식 1.11 에서 두 개의 표본 평균 \\(\\bar {x}_{i.}\\)와 \\(\\bar {x}_{j.}\\) 은 서로 독립인 것에 유의하자.\n이제 마지막으로 두 평균의 차이 \\(\\delta_{ij}\\) 에 대한 가설을 검정하여고 한다.\n\\[ H_0 : \\alpha_i = \\alpha_j \\quad \\text{ vs. } \\quad H_1: \\alpha_i \\ne \\alpha_j \\]\n유의 수준 \\(\\alpha\\)에서 다음과 같은 조건을 만족하면 위의 귀무가설을 기각한다.\n\\[\n\\left | \\bar {x}_{i.} - \\bar {x}_{j.} \\right | &gt; t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{2MS_E}{r}}\n\\tag{1.12}\\]\n식 1.12 에서 주어진 귀무 가설 \\(\\delta_{ij}=0\\) 을 기각하는 조건은 식 1.11 에 주어진 신뢰구간이 0 을 포함하지 않는 조건과 동일하다.\n식 1.12 에서 검정을 위한 조건의 우변을 최소유의차(least significant difference; LSD) 라고 부른다. 두 수준의 차이가 유의하려면 두 평균 차이의 절대값이 최소한 최소유의차의 값보다 커야한다.\n\\[  \\text{LSD} =t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{2MS_E}{r}}  \\]\n\n\n1.3.7 예제 3.1 - ANOVA F-검정과 사후 추정\n다시 예제 3.1의 실험 자료를 고려한다.\n\ndf31\n\n   company response\n1        1     1.93\n2        1     2.38\n3        1     2.20\n4        1     2.25\n5        2     2.55\n6        2     2.72\n7        2     2.75\n8        2     2.70\n9        3     2.40\n10       3     2.68\n11       3     2.32\n12       3     2.28\n13       4     2.33\n14       4     2.38\n15       4     2.28\n16       4     2.25\n\ndf31s &lt;- df31 %&gt;% group_by(company)  %&gt;%  summarise(mean=mean(response), median= median(response), sd=sd(response), min=min(response), max=max(response))\n\ndf31s\n\n# A tibble: 4 × 6\n  company  mean median     sd   min   max\n  &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 1        2.19   2.22 0.189   1.93  2.38\n2 2        2.68   2.71 0.0891  2.55  2.75\n3 3        2.42   2.36 0.180   2.28  2.68\n4 4        2.31   2.30 0.0572  2.25  2.38\n\n\n예제 3.1에서 실험의 목적은 4개의 직물의 긁힘에 대한 저항력을 비교하는 실험이다.\n\nggplot(df31, aes(company, response)) +\n  geom_boxplot() + \n  geom_line(data=df31s, aes(x=company, y=mean, group=1), size=1.5, col=\"#9ACBF9\") +\n  geom_point(data=df31s, aes(x=company, y=mean), col=\"darkblue\", size=3) +\n  theme_bw()\n\n\n\n\n\n\n\n\n이제 위에서 제시한 F-검정을 이용하여 납품 업체 간에 직물 마모도에 차이가 있는지 검정해보자.\n\\[ H_0: \\mu_1=\\mu_2=\\mu_3=\\mu_4 \\quad \\text{ vs. }\\quad H_1: \\text{ not } H_0 \\]\n\nanova.res &lt;- aov(response~company,data=df31) \nsummary(anova.res)\n\n            Df Sum Sq Mean Sq F value  Pr(&gt;F)   \ncompany      3 0.5240 0.17467   8.785 0.00235 **\nResiduals   12 0.2386 0.01988                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n위의 분산분석표에서 p-값이 유의수준 5% 보다 매우 작으므로 네 개의 직물에 대한 평균이 같다는 귀무가설을 기각한다. 따라서 4개의 납품업체에서 받은 직물의 저항력이 유의하게 다르다고 할 수 있다. 여기서 유의할 점은 ANOVA를 이용한 F-검정은 그룹 간의 차이가 있다는 것을 의미하지만 어떻게 다른지에 대한 정보를 주지 않는다.\n최소유의차(LSD) 방법에 의하여 처리 간의 평균을 신뢰구간을 구하고 차이가 있는지 검정할 수 있다.\n\n### Mean of response by factor\nresult1 &lt;- LSD.test(anova.res, \"company\", group=FALSE, console = TRUE)\n\n\nStudy: anova.res ~ \"company\"\n\nLSD t Test for response \n\nMean Square Error:  0.01988333 \n\ncompany,  means and individual ( 95 %) CI\n\n  response        std r         se      LCL      UCL  Min  Max    Q25   Q50\n1     2.19 0.18920888 4 0.07050414 2.036385 2.343615 1.93 2.38 2.1325 2.225\n2     2.68 0.08906926 4 0.07050414 2.526385 2.833615 2.55 2.75 2.6625 2.710\n3     2.42 0.18036999 4 0.07050414 2.266385 2.573615 2.28 2.68 2.3100 2.360\n4     2.31 0.05715476 4 0.07050414 2.156385 2.463615 2.25 2.38 2.2725 2.305\n     Q75\n1 2.2825\n2 2.7275\n3 2.4700\n4 2.3425\n\nAlpha: 0.05 ; DF Error: 12\nCritical Value of t: 2.178813 \n\nComparison between treatments means\n\n      difference pvalue signif.         LCL         UCL\n1 - 2      -0.49 0.0004     *** -0.70724487 -0.27275513\n1 - 3      -0.23 0.0397       * -0.44724487 -0.01275513\n1 - 4      -0.12 0.2520         -0.33724487  0.09724487\n2 - 3       0.26 0.0229       *  0.04275513  0.47724487\n2 - 4       0.37 0.0030      **  0.15275513  0.58724487\n3 - 4       0.11 0.2916         -0.10724487  0.32724487\n\nresult1\n\n$statistics\n     MSerror Df Mean       CV  t.value       LSD\n  0.01988333 12  2.4 5.875345 2.178813 0.2172449\n\n$parameters\n        test p.ajusted  name.t ntr alpha\n  Fisher-LSD      none company   4  0.05\n\n$means\n  response        std r         se      LCL      UCL  Min  Max    Q25   Q50\n1     2.19 0.18920888 4 0.07050414 2.036385 2.343615 1.93 2.38 2.1325 2.225\n2     2.68 0.08906926 4 0.07050414 2.526385 2.833615 2.55 2.75 2.6625 2.710\n3     2.42 0.18036999 4 0.07050414 2.266385 2.573615 2.28 2.68 2.3100 2.360\n4     2.31 0.05715476 4 0.07050414 2.156385 2.463615 2.25 2.38 2.2725 2.305\n     Q75\n1 2.2825\n2 2.7275\n3 2.4700\n4 2.3425\n\n$comparison\n      difference pvalue signif.         LCL         UCL\n1 - 2      -0.49 0.0004     *** -0.70724487 -0.27275513\n1 - 3      -0.23 0.0397       * -0.44724487 -0.01275513\n1 - 4      -0.12 0.2520         -0.33724487  0.09724487\n2 - 3       0.26 0.0229       *  0.04275513  0.47724487\n2 - 4       0.37 0.0030      **  0.15275513  0.58724487\n3 - 4       0.11 0.2916         -0.10724487  0.32724487\n\n$groups\nNULL\n\nattr(,\"class\")\n[1] \"group\"\n\n\n최소유의차(LSD) 방법에 의한 평균의 차이에 대한 결과를 이용하여 처리를 다음과 같이 그룹화 하여 보여줄 수 있다.\n\nresult2 &lt;- LSD.test(anova.res, \"company\", group=TRUE, console = TRUE)\n\n\nStudy: anova.res ~ \"company\"\n\nLSD t Test for response \n\nMean Square Error:  0.01988333 \n\ncompany,  means and individual ( 95 %) CI\n\n  response        std r         se      LCL      UCL  Min  Max    Q25   Q50\n1     2.19 0.18920888 4 0.07050414 2.036385 2.343615 1.93 2.38 2.1325 2.225\n2     2.68 0.08906926 4 0.07050414 2.526385 2.833615 2.55 2.75 2.6625 2.710\n3     2.42 0.18036999 4 0.07050414 2.266385 2.573615 2.28 2.68 2.3100 2.360\n4     2.31 0.05715476 4 0.07050414 2.156385 2.463615 2.25 2.38 2.2725 2.305\n     Q75\n1 2.2825\n2 2.7275\n3 2.4700\n4 2.3425\n\nAlpha: 0.05 ; DF Error: 12\nCritical Value of t: 2.178813 \n\nleast Significant Difference: 0.2172449 \n\nTreatments with the same letter are not significantly different.\n\n  response groups\n2     2.68      a\n3     2.42      b\n4     2.31     bc\n1     2.19      c\n\n\n\nresult2$groups\n\n  response groups\n2     2.68      a\n3     2.42      b\n4     2.31     bc\n1     2.19      c\n\nplot(result2)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>일원배치법</span>"
    ]
  },
  {
    "objectID": "qmd/twoway.html",
    "href": "qmd/twoway.html",
    "title": "2  이원배치법",
    "section": "",
    "text": "2.1 예제 4.1\n예제 4.1 은 교과서 89 페이지에 나온 분석 예제이다. 4종류의 사료(A)와 3종류의 돼지품종(B)이 체중 증가에 미치는 영향을 조사한 실험이다. 각 처리 조합마다 3회 반복실험하여 총 36개의 관측값을 얻었다.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>이원배치법</span>"
    ]
  },
  {
    "objectID": "qmd/twoway.html#예제-4.1",
    "href": "qmd/twoway.html#예제-4.1",
    "title": "2  이원배치법",
    "section": "",
    "text": "2.1.1 자료 읽기\n다음과 같은 순서로 자료를 가진 데이터프레임 df2을 만들어 보자.\n\nresponse&lt;- c(64, 66, 70, 72, 81, 64, \n             74, 51, 65, 65, 63, 58,\n             57, 43, 52, 47, 58, 67,\n             59, 68, 65, 66, 71, 59,\n             58, 39, 42, 58, 41, 46,\n             57, 61, 53, 53, 59, 38)\nresponse\n\n [1] 64 66 70 72 81 64 74 51 65 65 63 58 57 43 52 47 58 67 59 68 65 66 71 59 58\n[26] 39 42 58 41 46 57 61 53 53 59 38\n\n\n\nfood&lt;- factor(rep(c(1:4), each=9)) \nbreed&lt;- factor(rep(c(1:3), each=3))\nfood\n\n [1] 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 4 4 4 4 4 4 4 4 4\nLevels: 1 2 3 4\n\nbreed\n\n[1] 1 1 1 2 2 2 3 3 3\nLevels: 1 2 3\n\n\n\ndf2&lt;- data.frame(food, breed, response)\nhead(df2)\n\n  food breed response\n1    1     1       64\n2    1     1       66\n3    1     1       70\n4    1     2       72\n5    1     2       81\n6    1     2       64\n\n\n\n\n2.1.2 자료의 시각화와 기초 통계량\n이제 처리별로 효과를 시각적으로 비교하기 위하여 자료들에 대한 산점도와 상자그림을 그려보자\n\ndf2 %&gt;% \n  ggplot() +\n  aes(x = food , y = response, fill=breed, color=breed) +\n  geom_boxplot(alpha = 0.1, width = 0.75)\n\n\n\n\n\n\n\n\n\ndf2 %&gt;% \n  ggplot() +\n  aes(x = breed  , y = response, fill=food, color=food) +\n  geom_boxplot(alpha = 0.1, width = 0.75) \n\n\n\n\n\n\n\n\n위와 같이 두 요인의 조합으로 그림을 보는 것보다 각 요인별로 요약하여 보는 것도 유용하다.\n\ndf2 %&gt;% \n  ggplot( aes(x = food , y = response) ) +\n  geom_boxplot()\n\n\n\n\n\n\n\n\n\ndf2 %&gt;% \n  ggplot( aes(x = breed , y = response))  +\n  geom_boxplot()\n\n\n\n\n\n\n\n\n다음으로 12개의 처리 조합에 대한 체중의 기초통계량(평균과 표준편차)을 구해보자.\n\ndf2s &lt;- df2 %&gt;% group_by(food, breed)  %&gt;%  summarise(mean=mean(response),  sd=sd(response))\ndf2s\n\n# A tibble: 12 × 4\n# Groups:   food [4]\n   food  breed  mean    sd\n   &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1 1     1      66.7  3.06\n 2 1     2      72.3  8.50\n 3 1     3      63.3 11.6 \n 4 2     1      62    3.61\n 5 2     2      50.7  7.09\n 6 2     3      57.3 10.0 \n 7 3     1      64    4.58\n 8 3     2      65.3  6.03\n 9 3     3      46.3 10.2 \n10 4     1      48.3  8.74\n11 4     2      57    4   \n12 4     3      50   10.8 \n\n\n또한 각 요인에 대한 기초통계량도 구해보자.\n\ndf2s_food&lt;- df2 %&gt;% group_by(food)  %&gt;%  summarise(mean=mean(response),  sd=sd(response))\ndf2s_food\n\n# A tibble: 4 × 3\n  food   mean    sd\n  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 1      67.4  8.34\n2 2      56.7  8.08\n3 3      58.6 11.2 \n4 4      51.8  8.26\n\n\n\ndf2s_breed &lt;- df2 %&gt;% group_by(breed)  %&gt;%  summarise(mean=mean(response),  sd=sd(response))\ndf2s_breed\n\n# A tibble: 3 × 3\n  breed  mean    sd\n  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 1      60.2  8.74\n2 2      61.3 10.3 \n3 3      54.2 11.4 \n\n\n이제 위에서 계산된 처리 그룹에 대한 평균으로 상호작용 그림을 그려보자. 아래 그림에서 사료의 종류에 따라서 체중의 변화를 본 그림이다. 사료 1번에서 체중이 가장 크게 나타났고 다른 사료에 대해서는 체중이 줄어드는데 품종에 따라서 그 크기가 서로 다르다.\n\ndf2s %&gt;% \n  ggplot() +\n  aes(x = food , y = mean, color =breed) +\n  geom_line(aes(group = breed)) +\n  geom_point()\n\n\n\n\n\n\n\n\n아래 그림은 아래 그림에서 품종의 종류에 따라서 체중의 변화를 본 그림이다.\n\ndf2s %&gt;% \n  ggplot() +\n  aes(x = breed , y = mean, color =food) +\n  geom_line(aes(group = food)) +\n  geom_point()\n\n\n\n\n\n\n\n\n사료와 품종간에 상호 작용이 그림으로 나타나고 있지만 뚜렸하지 않고 해석하기도 힘들다.\n\n\n2.1.3 분산분석표와 가설검정\n이제 이원배치법에서의 가설검정을 수행하기 위하여 분산분석 표를 구해보자.\n\ndf2aov &lt;- aov(response ~ food*breed, data=df2)\nsummary(df2aov)\n\n            Df Sum Sq Mean Sq F value  Pr(&gt;F)   \nfood         3 1156.6   385.5   6.163 0.00294 **\nbreed        2  349.4   174.7   2.793 0.08121 . \nfood:breed   6  771.3   128.5   2.055 0.09712 . \nResiduals   24 1501.3    62.6                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n상호작용에 대한 가설 검정\n\n\\[\nH_0: (\\alpha \\beta)_{11} = (\\alpha \\beta)_{12} =\\cdots = (\\alpha \\beta)_{6} =0 \\quad \\text{ vs.} \\quad H_1: \\text{ not } H_0\n\\]\n분산분석표에서 상호작용에 대한 가설 검정을 위한 F-통계량은 \\(2.055\\)이고 p-값은 0.097으로 유의수준 0.05보다 크므로 귀무가설 \\(H_0\\)를 기각할 수 있다. 따라서 사료와 품종 간의 상호작용은 유의하지 않다. 하지만 p-값이 0.1 미만이므로 품종에 따라서 사료가 주는 효과가 약간은 다를 가능성이 존재한다.\n\n\n\n\n\n\n노트\n\n\n\n상호작용에 대한 p-값이 0.25 보다 작으므로 상호작용에 대한 모수를 가진 모형을 그대로 사용한다. (교과서 88 페이지 참조 )\n상호작용을 모형에서 제외하는 기준을 일반적으로 정하는 방법은 매우 어려우며 실험계획의 적용되는 분야와 문제에 따라 달리질 수 있다. 또한 기준을 설벙할 떄는 고유 분야에 대한 지식과 경험이 필요하다.\n본 강의에서는 학생들이 상호작용을 모형에서 제외하는판단은 하지 않으며 과제나 시험에서 상호작용을 모형에서 제외하는 판단을 요구하지 않는다.\n\n\n\n주효과에 대한 가설 검정\n주효과에 대한 검정에서 품종에 대한 검정은 p-값이 \\(0.081\\)로서 유의수준 5%에서 귀무가설을 기각할 수 없으므로 돼지품종에 따라서는 유의한 차이가 없다. 다만 유의수준 1%에서는 유의하므로 약간의 차이는 있다고 말할 수 있다.\n사료에 대한 검정은 p-값이 \\(0.003\\)로서 유의수준 5%에서 귀무가설을 기각할 수 있어서 사료에 따라서는 유의한 차이가 있다.\n\n\n\n\n\n\n\n노트\n\n\n\n보통 유의수준 1%에서 유의하면 “제한적으로 유의하다”(marginally significant)라고 말한다.\n\n\n\n\n2.1.4 분산분석 후의 추정\n\n2.1.4.1 모평균에 대한 추론\n이원배치에서 유의한 상호작용이 있는 경우 처리수준 \\(A_iB_j\\)에 대한 모평균 \\(\\mu_{ij}\\) 에 대한 추정량은 처리수준 \\(A_iB_j\\)에서의 관측값들의 평균 \\(\\bar {x}_{ij.}\\) 이며 오차항의 분산 \\(\\sigma^2_E\\)는 분산분석표에서 \\(MS_E\\)로 추정할 수 있다.\n\\[ \\hat \\sigma^2_E = MS_E = \\frac{SS_E}{ab(r-1)} =\\frac{1501.3}{24} = 62.6 \\]\n위의 결과를 이용하면 처리수준 \\(A_iB_j\\)에 대한 모평균 \\(\\mu_{ij}\\)에 대한 \\(100(1-\\alpha)\\)% 신뢰구간은 다음과 같이 주어진다.\n\\[ \\bar x_{ij.} \\pm t(1-\\alpha/2, ab[r-1]) \\sqrt{ \\frac{MS_E}{r}} \\]\n예를 들어 사료가 1 이고(\\(i=1\\)) 품종이 1인 경우(\\(j=1\\)) 체중의 평균 \\(\\mu_{11}\\) 에 대한 95% 신뢰 구간을 구해보자. 일단 위의 기초 통계량에서 \\(\\bar x_{11.}=66.7\\) 이고 분산분석표에서 \\(MS_E =62.6\\), \\(r=3\\) 그리고 t-분포의 백분위수 \\(t(0.975, 24)\\) 은 다음과 같이 주어진다.\n\nqt(0.975, 24)\n\n[1] 2.063899\n\n\n따라서 \\(\\mu_{11}\\) 에 대한 95% 신뢰 구간은 다음과 같다.\n\\[\n\\bar x_{11.} \\pm t(1-\\alpha/2, 24) \\sqrt{ \\frac{MS_E}{r}} = 66.7 \\pm (2.06)\\sqrt{\\frac{62.6}{3}} = 66.7 \\pm (2.06)(4.56)= (57, 76)\n\\tag{2.1}\\]\n패키지 emmeans에 있는 함수 emmeans()를 다음과 같이 사용하면 각 처리에 대한 평균의 95% 신뢰구간을 쉽게 구할 수 있다.\n\nemmeans(df2aov, \"food\", \"breed\")\n\nbreed = 1:\n food emmean   SE df lower.CL upper.CL\n 1      66.7 4.57 24     57.2     76.1\n 2      62.0 4.57 24     52.6     71.4\n 3      64.0 4.57 24     54.6     73.4\n 4      48.3 4.57 24     38.9     57.8\n\nbreed = 2:\n food emmean   SE df lower.CL upper.CL\n 1      72.3 4.57 24     62.9     81.8\n 2      50.7 4.57 24     41.2     60.1\n 3      65.3 4.57 24     55.9     74.8\n 4      57.0 4.57 24     47.6     66.4\n\nbreed = 3:\n food emmean   SE df lower.CL upper.CL\n 1      63.3 4.57 24     53.9     72.8\n 2      57.3 4.57 24     47.9     66.8\n 3      46.3 4.57 24     36.9     55.8\n 4      50.0 4.57 24     40.6     59.4\n\nConfidence level used: 0.95",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>이원배치법</span>"
    ]
  },
  {
    "objectID": "qmd/twoway.html#반복이-있는-이원배치에서-상호작용이-없는-경우의-추론",
    "href": "qmd/twoway.html#반복이-있는-이원배치에서-상호작용이-없는-경우의-추론",
    "title": "2  이원배치법",
    "section": "2.2 반복이 있는 이원배치에서 상호작용이 없는 경우의 추론",
    "text": "2.2 반복이 있는 이원배치에서 상호작용이 없는 경우의 추론\n교과서에서 상호작용의 유의성에 따라서 모형을 축소하는 기준을 다음과 같이 제시하고 있다.\n상호작용에 대한 p-값이 0.25보다 큰 경우 상호작용이 존재하지 않는다고 판단하고 오차항에 풀링힌다. 상호작용을 오차항에 풀링한다는 것은 다음과 같은 모형을 사용한다는 의미이다.\n\\[\nx_{ijk} = \\mu + \\alpha_i + \\beta_j + e_{ijk}\n\\tag{2.2}\\]\n만약 예제 4.1에 대한 반복이 있는 자료에서 위와 같이 오차항을 풀링한 모형을 적합해 보면 아래와 같은 분산분석표를 얻는다.\n\ndf2aov2 &lt;- aov(response ~ food + breed, data=df2)\nsummary(df2aov2)\n\n            Df Sum Sq Mean Sq F value  Pr(&gt;F)   \nfood         3 1156.6   385.5   5.089 0.00575 **\nbreed        2  349.4   174.7   2.306 0.11705   \nResiduals   30 2272.6    75.8                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n만약 반복이 있는 이원배치 모형에서 상호작용 \\(A \\times B\\)가 존재하지 않고 주효과만 유의한 경우, 즉 모형 식 2.2 을 가정한 경우 모평균 \\(\\mu_{ij}\\)에 대한 모수는 다음과 같다.\n\\[ \\mu_{ij} = \\mu + \\alpha_i + \\beta_j \\]\n이러한 경우 모평균 \\(\\mu_{ij}\\)에 대한 최소제곱 추정량(least square estimator)은 표본 평균 \\(\\bar x_{ij.}\\)이 아니라 다음과 같은 추정량이 주어진다.\n\\[\n\\begin{aligned}\n\\hat \\mu_{ij} & = \\hat \\mu + \\hat \\alpha_i + \\hat \\beta_j \\\\\n  & = (\\bar{\\bar x}) + (\\bar x_{i..}-\\bar{\\bar x}) + (\\bar x_{.j.}-\\bar{\\bar x}) \\\\\n  & = \\bar x_{i..} + \\bar x_{.j.} - \\bar{\\bar x}\n\\end{aligned}\n\\]\n위에서 주어진 \\(\\hat \\mu_{ij}\\) 는 모평균 \\(\\mu_{ij}\\)의 불편 추정량이며 상호작용 \\(A \\times B\\) 이 없는 모형 @ref(eq:nointer) 에서 표본 평균 \\(\\bar x_{ij.}\\) 보다 분산이 작은 추정량이다. 즉,\n\\[ Var \\left (\\hat \\mu_{ij} \\right ) = \\frac{\\sigma_E^2}{n_e}  \\le \\frac{\\sigma_E^2}{r} = Var (\\bar x_{ij.} )    \\]\n위의 식에서 유효 반복수 \\(n_e\\) 는 다음과 같이 정의된다.\n\\[ \\frac{1}{n_e} = \\frac{1}{br} + \\frac{1}{ar} - \\frac{1}{abr}, \\quad n_e=\\frac{abr}{a+b-1} \\]\n따라서 이 경우 모평균 \\(\\mu_{ij}\\)에 대한 \\(100(1-\\alpha)\\)% 신뢰구간은 다음과 같은 주어진다.\n\\[ \\hat \\mu_{ij} \\pm t(1-\\alpha/2, \\phi_E) \\sqrt{ \\frac{MS_E}{n_e}} \\]\n주의할 점은 위의 신뢰구간에서 \\(MS_E\\)는 상호작용이 없는 모형 식 2.2 으로 유도된 분산분석표에 나타난 \\(MS_E\\) 이며 자유도는 \\(\\phi_E = abr-a-b+1\\) 이다.\n참고로 예제 4.1 경우 \\(a=4\\), \\(b=3\\), \\(r=3\\)이므로 유효 반복수 \\(n_e\\) 는 다음과 같이 주어진다.\n\\[ n_e = \\frac{abr}{a+b-1} = \\frac{(4)(3)(3)}{4+3-1} = 6  \\]\n상호작용 \\(A \\times B\\) 이 없는 모형 식 2.2 에서 적용한 분산분석 결과 df2aov2 에 대하여 모형 식 2.2 에서 각 처리에 대한 평균 \\(\\mu_{ij}\\)에 대한 최소제곱 추정량 \\(\\hat \\mu_{ij}=\\bar x_{i..} + \\bar x_{.j.} - \\bar{\\bar x}\\) 과 95% 신뢰구간을 다음과 같이 구할 수 있다.\n\ndf2s_food$mean[1]\n\n[1] 67.44444\n\ndf2s_breed$mean[1]\n\n[1] 60.25\n\nmean(df2$response)\n\n[1] 58.61111\n\n\n\\[ \\hat \\mu_{ij}=\\bar x_{i..} + \\bar x_{.j.} - \\bar{\\bar x} = 67.4 +  60.3 - 58.6 =69.1 \\]\n이제 상호작용 \\(A \\times B\\) 이 없는 모형 식 2.2 에서 \\(\\mu_{11}\\) 에 대한 95% 신뢰 구간은 다음과 같다.\n\\[\n\\begin{aligned}\n\\hat \\mu_{11}  \\pm t(1-\\alpha/2, 30) \\sqrt{ \\frac{MS_E}{n_e}}\n& = 69.1 \\pm (2.04)\\sqrt{\\frac{ 75.8}{6}} \\\\\n& = 69.1 \\pm (2.04)(3.55) \\\\\n& = (61.8, 76.3)\n\\end{aligned}\n\\]\n위의 신뢰구간 \\((61.8, 76.3)\\)은 상호 작용이 포함된 모형에서 유도힌 신뢰구간 식 2.1 에서 구한 \\((57, 76)\\)과 다르다.\n함수 emmeans()를 분산분석 결과df2aov2 에 대하여 다음과 같이 사용하면 상호작용 \\(A \\times B\\) 이 없는 모형 식 2.2 에서 각 처리에 대한 평균 \\(\\mu_{ij}\\)에 대한 최소제곱 추정량 \\(\\hat \\mu_{ij}\\) 과 95% 신뢰구간을 다음과 같이 구할 수 있다.\n\nemmeans(df2aov2, \"food\", \"breed\")\n\nbreed = 1:\n food emmean   SE df lower.CL upper.CL\n 1      69.1 3.55 30     61.8     76.3\n 2      58.3 3.55 30     51.0     65.6\n 3      60.2 3.55 30     52.9     67.5\n 4      53.4 3.55 30     46.2     60.7\n\nbreed = 2:\n food emmean   SE df lower.CL upper.CL\n 1      70.2 3.55 30     62.9     77.4\n 2      59.4 3.55 30     52.1     66.6\n 3      61.3 3.55 30     54.0     68.5\n 4      54.5 3.55 30     47.2     61.8\n\nbreed = 3:\n food emmean   SE df lower.CL upper.CL\n 1      63.1 3.55 30     55.8     70.3\n 2      52.3 3.55 30     45.0     59.6\n 3      54.2 3.55 30     46.9     61.5\n 4      47.4 3.55 30     40.2     54.7\n\nConfidence level used: 0.95 \n\n\n위에서 나타난 emmean 은 \\(\\mu_{ij}\\)에 대한 최소제곱 추정량 \\(\\bar x_{i..} + \\bar x_{.j.} - \\bar{\\bar x}\\) 으로서 아래 주어진 표본평균 \\(\\bar x_{ij.}\\) 과 다른 값으로 나타남을 알 수 있다.\n\ndf2s\n\n# A tibble: 12 × 4\n# Groups:   food [4]\n   food  breed  mean    sd\n   &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt;\n 1 1     1      66.7  3.06\n 2 1     2      72.3  8.50\n 3 1     3      63.3 11.6 \n 4 2     1      62    3.61\n 5 2     2      50.7  7.09\n 6 2     3      57.3 10.0 \n 7 3     1      64    4.58\n 8 3     2      65.3  6.03\n 9 3     3      46.3 10.2 \n10 4     1      48.3  8.74\n11 4     2      57    4   \n12 4     3      50   10.8",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>이원배치법</span>"
    ]
  },
  {
    "objectID": "qmd/twoway.html#전지의-수명-실험",
    "href": "qmd/twoway.html#전지의-수명-실험",
    "title": "2  이원배치법",
    "section": "2.3 전지의 수명 실험",
    "text": "2.3 전지의 수명 실험\n전지(battery)를 제조하는 회사의 기술자들이 전지의 수명(BatteryLife)에 영향을 미치는 두 요인, 온도(Temperature)와 재료(MaterialType)의 효과를 알아보기 위해서 실행한 실험입니다.\n기술자들은 온도가 크게 변할 때 전지의 수명에 어떤 영향을 미치는지 알아보기 위하여 실험을 실시하였다. 온도는 3개의 수준(15도, 70도, 125도)을 고려하였다. 전지를 생산하는 재료가 3개이므로 재료는 3개의 수준(type 1,2,3)으로 구성되어 있다. 이 실험은 9 개의 처리(\\(ab=3\\times 3=9\\))에 대하여 각각 4번의 반복 측정(\\(r=4\\))을 실시하였다.\n자료의 출처는 (Montgomery 2017) 에 나와 있다\n자료를 얻기 위해서는 다음과 같은 R 프로그램을 실행하여 패키지 MontgomeryDAE를 설치하고 실행해야 한다.\n\ninstall.packages(\"remotes\")\nremotes::install_github(\"ehassler/MontgomeryDAE\")\nlibrary(MontgomeryDAE)\n\n\n2.3.1 자료 읽기\n이제 전지의 수명 실험 자료를 읽어 오자. 전지의 수명 실험에 대한 자료는 데이터프레임 Table5.1에 있다.\n\ndf &lt;- Table5.1\nhead(df) # 자료의 앞부부만 보기   \n\n  MaterialType Temperature BatteryLife\n1            1          15         130\n2            1          15          74\n3            2          15         150\n4            2          15         159\n5            3          15         138\n6            3          15         168\n\n\n함수 str()은 자료의 구조와 자료 안에 있는 변수의 형식을 보여준다.\n\nstr(df)  # 자료의 구조를 알아보는 명령\n\n'data.frame':   36 obs. of  3 variables:\n $ MaterialType: chr  \"1\" \"1\" \"2\" \"2\" ...\n $ Temperature : num  15 15 15 15 15 15 15 15 15 15 ...\n $ BatteryLife : num  130 74 150 159 138 168 155 180 188 126 ...\n\n\n위의 결과를 보면 데이터프레임 df에 있는 변수 MaterialType은 문자형 변수(chr)이고 나머지는 숫자형 변수(num)이다. 두 요인에 대한 변수인 MaterialType와 Temperature를 함수 factor()를 이용하여 범주형 변수로 만들어 주자 .\n\ndf$MaterialType &lt;- factor(df$MaterialType)\ndf$Temperature &lt;- factor(df$Temperature)\nstr(df)\n\n'data.frame':   36 obs. of  3 variables:\n $ MaterialType: Factor w/ 3 levels \"1\",\"2\",\"3\": 1 1 2 2 3 3 1 1 2 2 ...\n $ Temperature : Factor w/ 3 levels \"15\",\"70\",\"125\": 1 1 1 1 1 1 1 1 1 1 ...\n $ BatteryLife : num  130 74 150 159 138 168 155 180 188 126 ...\n\n\n\n\n2.3.2 자료의 시각화와 기초 통계량\n이제 처리별로 효과를 시각적으로 비교하기 위하여 자료들에 대한 산점도와 상자그림을 그려보자\n\ndf %&gt;% \n  ggplot() +\n  aes(x = Temperature , y = BatteryLife, fill=MaterialType, color=MaterialType, group = interaction(Temperature, MaterialType)) +\n  geom_boxplot(alpha = 0.1, width = 0.75) \n\n\n\n\n\n\n\n\n다음으로 6개의 처리 조합에 대한 전지 수명의 기초통계량(평균과 표준편차)을 구해보자.\n\ndfs &lt;- df %&gt;% group_by(MaterialType, Temperature)  %&gt;%  summarise(mean=mean(BatteryLife),  sd=sd(BatteryLife))\ndfs\n\n# A tibble: 9 × 4\n# Groups:   MaterialType [3]\n  MaterialType Temperature  mean    sd\n  &lt;fct&gt;        &lt;fct&gt;       &lt;dbl&gt; &lt;dbl&gt;\n1 1            15          135.   45.4\n2 1            70           57.2  23.6\n3 1            125          57.5  26.9\n4 2            15          156.   25.6\n5 2            70          120.   12.7\n6 2            125          49.5  19.3\n7 3            15          144    26.0\n8 3            70          146.   22.5\n9 3            125          85.5  19.3\n\n\n이제 위에서 계산된 처리 그룹에 대한 평균으로 상호작용 그림을 그려보자. 아래 그림에서 온도가 증가할 수록 전지의 수명이 감소하는 경향을 보이고 있다. 또한 각 재료에 따른 온도의 변화가 수평으로 나타나지 않고 있음을 알 수 있다. 이러한 점은 온도와 재료 사이에 유의한 상호작용이 있다고 예측할 수 있다.\n\ndfs %&gt;% \n  ggplot() +\n  aes(x = Temperature , y = mean, color =MaterialType) +\n  geom_line(aes(group = MaterialType)) +\n  geom_point()\n\n\n\n\n\n\n\n\n\n\n2.3.3 분산분석표와 가설검정\n이제 다음과 같은 모형에서 이원배치법에서의 가설검정을 수행하기 위하여 분산분석 표를 구해보자.\n\\[ x_{ijk} = \\mu + \\alpha_i + \\beta_j + (\\alpha\\beta)_{ij} + e_{ijk} \\]\n\n\n\n\n\n\n\n\n\n\n요인\n제곱합\n자유도\n평균제곱합\n\\(F_0\\)\n\n\n\n\n요인 \\(A\\)\n\\(SS_A\\)\n\\(a-1\\)\n\\(MS_A\\)\n\\(MS_A/MS_E\\)\n\n\n요인 \\(B\\)\n\\(SS_B\\)\n\\(b-1\\)\n\\(MS_B\\)\n\\(MS_B/MS_E\\)\n\n\n상호작용 \\(A \\times B\\)\n\\(SS_{A \\times B}\\)\n\\((a-1)(b-1)\\)\n\\(MS_{A \\times B}\\)\n\\(MS_{A \\times B}/MS_E\\)\n\n\n잔차 \\(E\\)\n\\(SS_E\\)\n\\(ab(r-1)\\)\n\\(MS_E\\)\n\n\n\n총합\n\\(SS_T\\)\n\\(abr-1\\)\n\n\n\n\n\n\ndfaov &lt;- aov(BatteryLife~ MaterialType + Temperature + MaterialType:Temperature, data=df)\n# This is equivalent to aov(BatteryLife~ MaterialType *Temperature , data=df)\nsummary(dfaov)\n\n                         Df Sum Sq Mean Sq F value   Pr(&gt;F)    \nMaterialType              2  10684    5342   7.911  0.00198 ** \nTemperature               2  39119   19559  28.968 1.91e-07 ***\nMaterialType:Temperature  4   9614    2403   3.560  0.01861 *  \nResiduals                27  18231     675                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n상호작용에 대한 가설 검정\n\\[ H_0: (\\alpha \\beta)_{11} = (\\alpha \\beta)_{12} =\\cdots = (\\alpha \\beta)_{3,3} =0 \\quad \\text{ vs.} \\quad H_1: \\text{ not } H_0 \\]\n분산분석표에서 상호작용에 대한 가설 검정을 위한 F-통계량은 다음과 같다.\n\\[ F_0 = \\frac{MS_{A \\times B}}{MS_E} =\\frac{SS_{A\\times B}/\\phi_{AB}} {SS_E/\\phi_E} = \\frac{9614/4}{18231/27} = 3.560 \\]\n위의 F-통계량에 대한 p-값은 0.0186으로 유의수준 0.05보다 작으므로 귀무가설 \\(H_0\\)를 기각한다. 따라서 온도와 재료의 상호작용은 유의하다.\n주효과에 대한 가설 검정\n위에서 유의한 상호작용이 있다고 판단하였기 때문에 주효과에 대한 가설검정은 기술적 의미가 없다. 기술적으로 의미가 없다는 것은 유의한 상호작용이 있으면 이미 주효과 \\(A\\) 의크기가 \\(B\\) 의 수준에 따라서 다르므로 주효과가 유의하게 있다는 것을 뜻한다.\n\n\n\n2.3.4 분산분석 후의 추정\n\n\n2.3.5 모평균에 대한 추론\n이원배치에서 유의한 상호작용이 있는 경우 처리수준 \\(A_iB_j\\)에 대한 모평균 \\(\\mu_{ij}\\) 은 다음과 같다.\n\\[ \\mu_{ij} = \\mu + \\alpha_i + \\beta_j + (\\alpha \\beta)_{ij} = \\mu + \\tau_{ij} \\]\n이때 \\(\\mu_{ij}\\) 에 대한 추정량은 처리수준 \\(A_iB_j\\)에서의 관측값들의 평균 \\(\\bar {x}_{ij.}\\)으로 다음과 같은 분포를 따른다.\n\\[ \\bar {x}_{ij.} \\sim N(\\mu_{ij}, \\sigma^2_E/ r) \\]\n오차항의 분산 \\(\\sigma^2_E\\)는 분산분석표에서 \\(MS_E\\)로 추정할 수 있다.\n\\[ \\hat \\sigma^2_E = MS_E = \\frac{SS_E}{ab(r-1)} =\\frac{18231}{27} = 675 \\]\n위의 결과를 이용하면 처리수준 \\(A_iB_j\\)에 대한 모평균 \\(\\mu_{ij}\\)에 대한 \\(100(1-\\alpha)\\)% 신뢰구간은 다음과 같이 주어진다.\n\\[ \\bar x_{ij.} \\pm t(1-\\alpha/2, ab[r-1]) \\sqrt{ \\frac{MS_E}{r}}  \\]\n예를 들어 전지의 수명실험에서 온도가 70도이고(\\(i=2\\)) 재료의 형테가 3인 경우(\\(j=3\\)) 수명 시간의 평균 \\(\\mu_{23}\\) 에 대한 95% 신뢰 구간을 구해보자. 일단 위의 기초 통계량에서 \\(\\bar x_{13.}=146\\) 이고 분산분석표에서 \\(MS_E =675\\), \\(r=4\\) 그리고 t-분포의 백분위수 \\(t(0.975, 27)\\) 은 다음과 같이 주어진다.\n\nqt(0.975, 27)\n\n[1] 2.051831\n\n\n따라서 \\(\\mu_{23}\\) 에 대한 95% 신뢰 구간은 다음과 같다.\n\\[ \\bar x_{23.} \\pm t(1-\\alpha/2, ab[r-1]) \\sqrt{ \\frac{MS_E}{r}} = 146 \\pm (2.05)\\sqrt{\\frac{675}{4}} = (119, 172) \\]\n패키지 emmeans에 있는 함수 emmeans()를 다음과 같이 사용하면 각 처리에 대한 평균의 95% 신뢰구간을 쉽게 구할 수 있다. 함수 emmeans()의 첫 번째 인자는 분산분석의 결과(aov()의 결과)이며 다음의 인자들은 요인에 대한 변수명을 써주면 된다.\n\nemmeans(dfaov, \"MaterialType\",\"Temperature\")\n\nTemperature = 15:\n MaterialType emmean SE df lower.CL upper.CL\n 1             134.8 13 27    108.1    161.4\n 2             155.8 13 27    129.1    182.4\n 3             144.0 13 27    117.3    170.7\n\nTemperature = 70:\n MaterialType emmean SE df lower.CL upper.CL\n 1              57.2 13 27     30.6     83.9\n 2             119.8 13 27     93.1    146.4\n 3             145.8 13 27    119.1    172.4\n\nTemperature = 125:\n MaterialType emmean SE df lower.CL upper.CL\n 1              57.5 13 27     30.8     84.2\n 2              49.5 13 27     22.8     76.2\n 3              85.5 13 27     58.8    112.2\n\nConfidence level used: 0.95 \n\n\n함수 emmeans()에서 출력되는 SE는 표분오차(standard error)를 의미하며 이는 평균의 추정량 \\(\\bar x_{ij.}\\)의 표준편차(standard deviation)이다.\n\\[  \\hat{\\text{SE}}(\\bar x_{ij.}) = \\hat{ sd} (\\bar x_{ij.}) = \\sqrt{ \\hat {Var} (\\bar x_{ij.})}\n= \\sqrt{\\frac{MS_E}{r}} = \\sqrt{675/4} = 13.0 \\]\n\n\n2.3.6 미래의 관측값에 대한 추론\n처리수준 \\(A_iB_j\\)에 대한 미래의 관측값에 대한 신뢰구간을 구하는 경우 관측 오차에 의한 불확실성을 반영하기 때문에 그 신뢰구간은 다음과 같이 주어진다.\n\\[ \\bar x_{ij.} \\pm t(1-\\alpha/2, ab[r-1]) \\sqrt{ \\frac{MS_E}{r}+MS_E}  \\]\n참고로 다른 교과서에서는 관측값에 대한 신뢰구간을 예측구간(prediction interval)이라고 부른다. 이는 모수는 추정(estimation)하지만 관측값은 예측(prediction)한다고 말하기 때문이다.\n\n\n\n\nMontgomery, Douglas C. 2017. Design and analysis of experiments. John wiley & sons.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>이원배치법</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Montgomery, Douglas C. 2017. Design and Analysis of\nExperiments. John wiley & sons.\n\n\n임용빈. 2020. Design Expert, Minitab 과 R을 활용한 실험계획법.\n자유아카데미.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "qmd/visual.html",
    "href": "qmd/visual.html",
    "title": "부록 A — R을 이용한 자료의 시각화 비교",
    "section": "",
    "text": "A.1 두 개 모집단의 비교",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>`R`을 이용한 자료의 시각화 비교</span>"
    ]
  },
  {
    "objectID": "qmd/visual.html#두-개-모집단의-비교",
    "href": "qmd/visual.html#두-개-모집단의-비교",
    "title": "부록 A — R을 이용한 자료의 시각화 비교",
    "section": "",
    "text": "A.1.1 예제 2.2 자료\n교재 2장의 예제 2.2 에서 소개된 인장 강도의 자료는 시멘트 공장의 2개의 생산라인에서 생산된 시멘트의 인장 강도를 측정한 것이다. 분석의 목적은 2개의 생산라인의 분포가 동일한지를 비교하는 것이다.\n먼저 R로 데이터프레임(data.frame)으로 만들어 보자. 예제 자료를 line1 과 line2 의 벡터 형식으로 만들고 data.frame의 형식인 df0에 저장하려면 다음과 같은 명령어를 사용하면 된다.\n\nline1 &lt;- c(16.9, 16.4, 17.2, 16.4, 16.5, 17.0, 17.0, 17.2, 16.6, 16.6)\nline2 &lt;- c(16.6, 16.8, 17.4, 17.1, 17.0, 16.9, 17.3, 17.0, 17.1, 17.3)\ndf220 &lt;- data.frame(line1, line2)\ndf220\n\n   line1 line2\n1   16.9  16.6\n2   16.4  16.8\n3   17.2  17.4\n4   16.4  17.1\n5   16.5  17.0\n6   17.0  16.9\n7   17.0  17.3\n8   17.2  17.0\n9   16.6  17.1\n10  16.6  17.3\n\n\ndata.frame 인 df0에는 각 그룹(line1과 line2)에 대한 10개의 자료가 2개의 열(column)에 각각 저장되어 있다. 이러한 자료의 형태를 넓은 형태의 자료(wide-format data)라고 부른다.\n위에서 만든 데이터프레임 df0 를 변형하여 반응값들을 하나의 변수(strength)로 합치고, 집단을 나타내는 변수 line를 생성하여 다른 형태의 데이터프레임 df를 다음과 같이 만들어 보자. 아래와 같은 형태의 자료를 좁은 형태의 자료(narrow-format data)라고 부른다. 넓은 형태보다 좁은 형태의 자료가 통계적 분석을 적용하기 편하다.\n\n# convert wide format to long format\ndf22&lt;- df220 %&gt;% pivot_longer(cols = everything(), names_to = \"line\", values_to = \"strength\") %&gt;% dplyr::arrange(line)\n\ndf22\n\n# A tibble: 20 × 2\n   line  strength\n   &lt;chr&gt;    &lt;dbl&gt;\n 1 line1     16.9\n 2 line1     16.4\n 3 line1     17.2\n 4 line1     16.4\n 5 line1     16.5\n 6 line1     17  \n 7 line1     17  \n 8 line1     17.2\n 9 line1     16.6\n10 line1     16.6\n11 line2     16.6\n12 line2     16.8\n13 line2     17.4\n14 line2     17.1\n15 line2     17  \n16 line2     16.9\n17 line2     17.3\n18 line2     17  \n19 line2     17.1\n20 line2     17.3\n\n\n\n\nA.1.2 기술 통계량에 의한 요약 - 넓은 형태의 자료\n넓은 형태의 자료 df0에 대한 요약통계(평균, 중앙값, 사분위수, 최소, 최대 등)를 다음과 같이 summary 함수를 이용하여 구하고 집단간의 차이를 비교할 수 있다.\n\nsummary(df220)\n\n     line1           line2      \n Min.   :16.40   Min.   :16.60  \n 1st Qu.:16.52   1st Qu.:16.93  \n Median :16.75   Median :17.05  \n Mean   :16.78   Mean   :17.05  \n 3rd Qu.:17.00   3rd Qu.:17.25  \n Max.   :17.20   Max.   :17.40  \n\n\n\n\nA.1.3 기술 통계량에 의한 요약 - 좁은 형태의 자료\n좁은 형태의 자료 df에 대해서는 다음과 같이 먼저 group_by함수로 집단을 구별하는 변수를 지정한다. 그 다음으로 summarise함수를 이용하여 여러 가지 통계량를 집단별로 계산할 수 있다.\n\ndf22 %&gt;% group_by(line)  %&gt;%  summarise(mean=mean(strength), median= median(strength), sd=sd(strength), min=min(strength), max=max(strength))\n\n# A tibble: 2 × 6\n  line   mean median    sd   min   max\n  &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 line1  16.8   16.8 0.316  16.4  17.2\n2 line2  17.0   17.0 0.246  16.6  17.4\n\n\n\n\nA.1.4 집단 자료에 대한 시각화\n다음으로 각 집단별로 상자그림(boxplot)을 그려서 자료의 중심과 퍼진 정도를 그림으로 비교해 보자. 위에서 좁은 형태로 구성된 자료에 대하여 다음과 같은 명령어로 상자그림을 집단별로 그릴 수 있다.\n\nwith(df22, boxplot(strength~line))\n\n\n\n\n\n\n\n\n패키지 ggplot2를 사용하면 좀 더 멋진 상자그림으로 시각화를 할 수 있다.\n\nggplot(df22, aes(line, strength)) +  geom_boxplot()",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>`R`을 이용한 자료의 시각화 비교</span>"
    ]
  },
  {
    "objectID": "qmd/visual.html#세-개-이상의-모집단의-비교",
    "href": "qmd/visual.html#세-개-이상의-모집단의-비교",
    "title": "부록 A — R을 이용한 자료의 시각화 비교",
    "section": "A.2 세 개 이상의 모집단의 비교",
    "text": "A.2 세 개 이상의 모집단의 비교\n\nA.2.1 예제 3.1 자료\n4개의 서로 다른 원단업체에서 직물을 공급받고 있다. 공급한 직물의 긁힘에 대한 저항력을 알아보기 위하여 각 업체마다 4개의 제품을 랜덤하게 선택하여 일원배치법에 의하여 마모도 검사을 실시하였다. 자료는 다음과 같다.\n\ncompany&lt;- as.factor(rep(c(1:4), each=4))\nresponse&lt;- c(1.93, 2.38, 2.20, 2.25,\n             2.55, 2.72, 2.75, 2.70,\n             2.40, 2.68, 2.32, 2.28,\n             2.33, 2.38, 2.28, 2.25)\ndf31&lt;- data.frame(company=company, response= response)\ndf31\n\n   company response\n1        1     1.93\n2        1     2.38\n3        1     2.20\n4        1     2.25\n5        2     2.55\n6        2     2.72\n7        2     2.75\n8        2     2.70\n9        3     2.40\n10       3     2.68\n11       3     2.32\n12       3     2.28\n13       4     2.33\n14       4     2.38\n15       4     2.28\n16       4     2.25\n\n\n\n\nA.2.2 기술 통계량에 의한 요약\n\ndf31s &lt;- df31 %&gt;% group_by(company)  %&gt;%  summarise(mean=mean(response), median= median(response), sd=sd(response), min=min(response), max=max(response))\ndf31s\n\n# A tibble: 4 × 6\n  company  mean median     sd   min   max\n  &lt;fct&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 1        2.19   2.22 0.189   1.93  2.38\n2 2        2.68   2.71 0.0891  2.55  2.75\n3 3        2.42   2.36 0.180   2.28  2.68\n4 4        2.31   2.30 0.0572  2.25  2.38\n\n\n\n\nA.2.3 집단 자료에 대한 시각화\n\nggplot(df31, aes(company, response)) +  geom_boxplot()\n\n\n\n\n\n\n\n\n\nggplot(df31, aes(company, response)) +\n  geom_boxplot() + \n  geom_line(data=df31s, aes(x=company, y=mean, group=1), size=1.5, col=\"#9ACBF9\") +\n  geom_point(data=df31s, aes(x=company, y=mean), col=\"darkblue\", size=3) +\n  theme_bw()",
    "crumbs": [
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>`R`을 이용한 자료의 시각화 비교</span>"
    ]
  }
]